!function(){"use strict";class e{constructor(e,t,s,i,r){this._title=e.name,this._link=e.link,this._id=e._id,this._templateSelector=t,this._handleCardClick=s,this._handleDeleteClick=i,this._handleLikeClick=r,this._likes=e.likes,this._ownerId=e.owner._id}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__icon-bin").addEventListener("click",(()=>{this._handleDeleteClick(this._id)})),this._element.querySelector(".card__icon").addEventListener("click",(e=>{this._handleLikeClick(this)})),this._element.querySelector(".card__img").addEventListener("click",(e=>{this._handleCardClick(this._title,this._link)}))}_setLikeIconOn(){this._element.querySelector(".card__icon").classList.add("card__icon_active")}_setLikeIconOff(){this._element.querySelector(".card__icon").classList.remove("card__icon_active")}addLike(e){this._setLikeIconOn(),this.isLiked=!0,this._likes=e.likes,this._editLikeCounter()}removeLike(e){this._setLikeIconOff(),this.isLiked=!1,this._likes=e.likes,this._editLikeCounter()}_deleteCard(){this._element.remove(),this._element=null}_handleInitialLikes(e){this._editLikeCounter(e),this.isLiked&&this._setLikeIconOn()}_editLikeCounter(){this._element.querySelector(".card__likes-counter").textContent=this._likes.length}getId(){return this._id}generateCard(e){this._element=this._getTemplate(),this.isLiked=this._likes.some((t=>t._id===e));const t=this._element.querySelector(".card__img"),s=this._element.querySelector(".card__title");return this._element.id=`card-${this._id}`,t.src=this._link,t.alt=`Photo of ${this._title}`,s.textContent=this._title,this._handleInitialLikes(e),this._setEventListeners(),this._ownerId!==e&&this._element.querySelector(".card__icon-bin").remove(),this._element}}class t{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach(this._renderer)}}class s{constructor(e,t){this._settings=e,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent="."}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_toggleButtonState(){this._hasInvalidInput()?this._disableButton():(this._buttonElement.classList.remove(this._settings.inactiveButtonClass),this._buttonElement.disabled=!1)}_disableButton(){this._buttonElement.classList.add(this._settings.inactiveButtonClass),this._buttonElement.disabled=!0}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._disableButton()}enableValidation(){this._inputList=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector),this._setEventListeners()}}class i{constructor(e){this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".popup__close-btn")}open(){this._popup.classList.add("popup_opened"),this._setEventListeners()}close(){this._popup.classList.remove("popup_opened"),this._removeEventListeners()}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleMouseClickClose=e=>{e.target.classList.contains("popup_opened")&&this.close()};_handleBtnClickClose=e=>{this.close()};_setEventListeners(){document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleMouseClickClose),this._closeButton.addEventListener("click",this._handleBtnClickClose)}_removeEventListeners(){document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleMouseClickClose),this._closeButton.removeEventListener("click",this._handleBtnClickClose)}}class r extends i{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".form"),this._formSubmitButton=this._form.querySelector(".form__submit"),this._formSubmitButtonText=this._formSubmitButton.textContent,this._inputs=Array.from(this._form.querySelectorAll(".form__input"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}_onSubmit=e=>{e.preventDefault(),this.renderLoading(!0),this._handleSubmit(this._getInputValues())};_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",this._onSubmit)}_removeEventListeners(){super._removeEventListeners(),this._form.removeEventListener("submit",this._onSubmit)}close(){super.close(),this._form.reset()}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._formSubmitButton.textContent=e?t:this._formSubmitButtonText}prePopulateFields(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}}const n={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"popup__field-submit_inactive",inputErrorClass:"form__input-error",errorClass:"popup__input-error_active"},o=document.querySelector(".profile__info-btn"),a=document.querySelector(".profile__add-btn"),l=document.querySelector(".profile__img-overlay"),h=(document.querySelector(".cards"),Array.from(document.querySelectorAll(n.formSelector)));let c;const _={},d=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.baseUrl=t,this.headers=s}getInitialCards(){return this._request(`${this.baseUrl}/cards`,{headers:this.headers})}getUserInformation(){return this._request(`${this.baseUrl}/users/me`,{headers:this.headers})}editUserInformation(e){let{name:t,job:s}=e;return this._request(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:s})})}addLike(e){return this._request(`${this.baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this.headers})}removeLike(e){return this._request(`${this.baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this.headers})}addNewCard(e){let{name:t,link:s}=e;return this._request(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:s})})}deleteCard(e){return this._request(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers})}editProfilePicture(e){let{avatar:t}=e;return this._request(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})})}_checkResponse(e){return e.ok?e.json():Promise.reject(`Error: ${e.status}`)}_request(e,t){return fetch(e,t).then(this._checkResponse)}fetchInitialData(){const e=this.getUserInformation(),t=this.getInitialCards();return Promise.all([e,t])}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"3392a7c3-5358-47ee-81fd-62f3278067e5","Content-Type":"application/json"}}),u=t=>{const s=new e(t,"#card-template",m,p,v);c.addItem(s.generateCard(f.userId))};function m(e,t){L.open(e,t)}function p(e){E.open(e)}function v(e){!0===e.isLiked?d.removeLike(e.getId()).then((t=>{e.removeLike(t)})).catch((e=>console.log(e))):d.addLike(e.getId()).then((t=>{e.addLike(t)})).catch((e=>console.log(e)))}const f=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._name=document.querySelector(t),this._job=document.querySelector(s),this._avatar=document.querySelector(i),this.userId=""}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent,avatar:this._avatar.src}}setUserInfo(e){let{name:t,about:s}=e;this._name.textContent=t,this._job.textContent=s}setUserAvatar(e){let{avatar:t}=e;this._avatar.src=t}}({nameSelector:".profile__info-name",jobSelector:".profile__info-job",avatarSelector:".profile__img"}),L=new class extends i{constructor(e){super(e),this._title=this._popup.querySelector(".img-popup__title"),this._image=this._popup.querySelector(".img-popup__img")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._title.textContent=e}}(".img-popup");d.fetchInitialData().then((e=>{let[s,i]=e;f.setUserInfo(s),f.setUserAvatar(s),f.userId=s._id,c=new t({items:i,renderer:u},".cards"),c.renderItems()})).catch((e=>console.log(e)));const k=new r(".profile-popup",(e=>{d.editUserInformation(e).then((e=>{f.setUserInfo(e),k.close(),k.renderLoading(!1)})).catch((e=>console.log(e))).finally((e=>k.renderLoading(!1)))})),S=new r(".avatar-popup",(e=>{d.editProfilePicture(e).then((e=>{f.setUserAvatar(e),S.close(),S.renderLoading(!1)})).catch((e=>console.log(e))).finally((e=>S.renderLoading(!1)))})),b=new r(".card-popup",(e=>{d.addNewCard({name:e.title,link:e.link}).then((e=>{u(e),b.close()})).catch((e=>{console.log("err",e)})).finally((e=>b.renderLoading(!1)))})),E=new class extends i{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".form__submit")}_onSubmit=e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleSubmit(this.imgId)};_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",this._onSubmit)}_removeEventListeners(){super._removeEventListeners(),this._form.removeEventListener("submit",this._onSubmit)}open(e){this.imgId=e,super.open()}close(){super.close(),this._submitButton.textContent="Yes"}}(".delete-popup",(e=>{d.deleteCard(e).then((t=>{document.querySelector(`#card-${e}`).remove(),E.close(),console.log("card removed")})).catch((e=>{console.log("err",e)}))}));a.addEventListener("click",(()=>{b.open(),_["card-popup__form"].resetValidation()})),o.addEventListener("click",(function(){k.prePopulateFields(f.getUserInfo()),k.open(),_.popup__form.resetValidation()})),l.addEventListener("click",(function(){S.prePopulateFields(f.getUserInfo()),S.open(),_.avatar__form.resetValidation()})),h.forEach((e=>{const t=new s(n,e);t.enableValidation(),_[e.id]=t}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LElBQUksTUFBT0YsRUFBSSxHQUN2QixJQWlCTmpELEVBQW1CM0csaUJBQWlCLFNBQVMsS0FDM0M0SyxFQUFhckcsT0FDYndDLEVBQWdCLG9CQUFvQmxELGlCQUFpQixJQUd2RDZDLEVBQWtCMUcsaUJBQWlCLFNBakJuQyxXQUNFeUssRUFBaUJsRSxrQkFBa0JnRCxFQUFRYyxlQUMzQ0ksRUFBaUJsRyxPQUNqQndDLEVBQTZCLFlBQUVsRCxpQkFDakMsSUFjQStDLEVBQWlCNUcsaUJBQWlCLFNBWmxDLFdBQ0UySyxFQUFnQnBFLGtCQUFrQmdELEVBQVFjLGVBQzFDTSxFQUFnQnBHLE9BQ2hCd0MsRUFBOEIsYUFBRWxELGlCQUNsQyxJQVlBZ0QsRUFBWXhFLFNBQVFHLElBQ2xCLE1BQU13SSxFQUFtQixJQUFJMUksRUFBY2tFLEVBQWtCaEUsR0FDN0R3SSxFQUFpQmpILG1CQUNqQmdELEVBQWdCdkUsRUFBSzFCLElBQU1rSyxDQUFnQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCB0ZW1wbGF0ZVNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrLCBoYW5kbGVMaWtlQ2xpY2spIHtcclxuICAgICAgICB0aGlzLl90aXRsZSA9IGRhdGEubmFtZTtcclxuICAgICAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgICAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcikuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIHJldHVybiBjYXJkVGVtcGxhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pY29uLWJpblwiKTtcclxuICAgICAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ljb25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltZ1wiKS5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKGUpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrKHRoaXMuX3RpdGxlLCB0aGlzLl9saW5rKTtcclxuICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgX3NldExpa2VJY29uT24oKSB7XHJcblxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pY29uXCIpLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19pY29uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBfc2V0TGlrZUljb25PZmYoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pY29uXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19pY29uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBhZGRMaWtlKHJlcykge1xyXG4gICAgICAgIHRoaXMuX3NldExpa2VJY29uT24oKTtcclxuICAgICAgICB0aGlzLmlzTGlrZWQgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gcmVzLmxpa2VzO1xyXG4gICAgICAgIHRoaXMuX2VkaXRMaWtlQ291bnRlcigpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUxpa2UocmVzKSB7XHJcbiAgICAgICAgdGhpcy5fc2V0TGlrZUljb25PZmYoKTtcclxuICAgICAgICB0aGlzLmlzTGlrZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9saWtlcyA9IHJlcy5saWtlcztcclxuICAgICAgICB0aGlzLl9lZGl0TGlrZUNvdW50ZXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBfZGVsZXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBfaGFuZGxlSW5pdGlhbExpa2VzKGlkKSB7XHJcbiAgICAgICAgdGhpcy5fZWRpdExpa2VDb3VudGVyKGlkKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuaXNMaWtlZCkge1xyXG4gICAgICAgICAgICB0aGlzLl9zZXRMaWtlSWNvbk9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9lZGl0TGlrZUNvdW50ZXIoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZExpa2VzID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VzLWNvdW50ZXJcIik7XHJcbiAgICAgICAgY2FyZExpa2VzLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIGdldElkKCl7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlQ2FyZChpZCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuaXNMaWtlZCA9IHRoaXMuX2xpa2VzLnNvbWUoKGxpa2UpID0+IGxpa2UuX2lkID09PSBpZCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGNhcmRJbWcgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1nXCIpO1xyXG4gICAgICAgIGNvbnN0IGNhcmRUaXRsZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5pZCA9IChgY2FyZC0ke3RoaXMuX2lkfWApO1xyXG5cclxuICAgICAgICBjYXJkSW1nLnNyYyA9IHRoaXMuX2xpbms7XHJcbiAgICAgICAgY2FyZEltZy5hbHQgPSBgUGhvdG8gb2YgJHt0aGlzLl90aXRsZX1gO1xyXG4gICAgICAgIGNhcmRUaXRsZS50ZXh0Q29udGVudCA9IHRoaXMuX3RpdGxlO1xyXG5cclxuICAgICAgICB0aGlzLl9oYW5kbGVJbml0aWFsTGlrZXMoaWQpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9vd25lcklkICE9PSBpZCkge1xyXG4gICAgICAgICAgICBjb25zdCBkZWxldGVCdXR0b24gPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faWNvbi1iaW5cIik7XHJcbiAgICAgICAgICAgIGRlbGV0ZUJ1dHRvbi5yZW1vdmUoKTtcclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcclxuXHJcbiAgICB9XHJcblxyXG5cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcclxuICAgICAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XHJcbiAgICB9XHJcblxyXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XHJcbiAgICB9XHJcblxyXG4gICAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMuZm9yRWFjaCh0aGlzLl9yZW5kZXJlcik7XHJcbiAgICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcclxuICBjb25zdHJ1Y3RvcihzZXR0aW5ncywgZm9ybSkge1xyXG4gICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG5cclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XHJcbiAgfTtcclxuXHJcbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgLiR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gXCIuXCI7XHJcbiAgfTtcclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmIChpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH1cclxuICB9O1xyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KCkpIHtcclxuICAgICAgdGhpcy5fZGlzYWJsZUJ1dHRvbigpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gZmFsc2U7XHJcblxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2Rpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoZSkgPT4ge1xyXG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xyXG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKXtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKGlucHV0ID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXQpO1xyXG4gICAgfSlcclxuICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICB9XHJcblxyXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QgPSBbLi4udGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9zZXR0aW5ncy5pbnB1dFNlbGVjdG9yKV07XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3Rvcih0aGlzLl9zZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufSIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwKTtcclxuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIucG9wdXBfX2Nsb3NlLWJ0blwiKTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5hZGQoXCJwb3B1cF9vcGVuZWRcIik7XHJcbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QucmVtb3ZlKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIHRoaXMuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUVzY0Nsb3NlID0gKGV2dCkgPT4ge1xyXG4gICAgICAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZU1vdXNlQ2xpY2tDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgICBpZiAoZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJwb3B1cF9vcGVuZWRcIikpIHtcclxuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfaGFuZGxlQnRuQ2xpY2tDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2hhbmRsZU1vdXNlQ2xpY2tDbG9zZSk7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUJ0bkNsaWNrQ2xvc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZW1vdmVFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVNb3VzZUNsaWNrQ2xvc2UpO1xyXG4gICAgICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVCdG5DbGlja0Nsb3NlKTtcclxuICAgIH1cclxufSIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwLCBzdWJtaXRDYWxsYmFja0Z1bmN0aW9uKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXApO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IHN1Ym1pdENhbGxiYWNrRnVuY3Rpb247XHJcbiAgICAgICAgY29uc3QgaW5wdXRTZWxlY3RvciA9IFwiLmZvcm1fX2lucHV0XCI7XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgICAgICB0aGlzLl9mb3JtU3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3N1Ym1pdFwiKTtcclxuICAgICAgICB0aGlzLl9mb3JtU3VibWl0QnV0dG9uVGV4dCA9IHRoaXMuX2Zvcm1TdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XHJcbiAgICAgICAgdGhpcy5faW5wdXRzID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoaW5wdXRTZWxlY3RvcikpO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgICAgICBjb25zdCB2YWx1ZXMgPSB7fTtcclxuICAgICAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgICAgICAgdmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlcztcclxuICAgIH1cclxuXHJcbiAgICBfb25TdWJtaXQgPSAoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLnJlbmRlckxvYWRpbmcodHJ1ZSk7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgfTtcclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX29uU3VibWl0KTtcclxuICAgIH1cclxuXHJcbiAgICBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX29uU3VibWl0KTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZywgbG9hZGluZ1RleHQ9J1NhdmluZy4uLicpIHtcclxuICAgICAgICBpZiAoaXNMb2FkaW5nKSB7XHJcbiAgICAgICAgICB0aGlzLl9mb3JtU3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZ1RleHQ7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRoaXMuX2Zvcm1TdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9mb3JtU3VibWl0QnV0dG9uVGV4dDtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICBwcmVQb3B1bGF0ZUZpZWxkcyhkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCJcclxuLy92YWxpZGF0aW9uIGNvbmZpZ1xyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19zdWJtaXRcIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19maWVsZC1zdWJtaXRfaW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmVcIlxyXG59XHJcblxyXG4vL3Byb2ZpbGUgZWRpdCBmb3JtIGVsZW1lbnRzXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW5mby1idG5cIik7XHJcbmV4cG9ydCBjb25zdCBuZXdDYXJkUG9wdXBCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmV4cG9ydCBjb25zdCBlZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWctb3ZlcmxheVwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc1wiKTtcclxuZXhwb3J0IGNvbnN0IGluaXRhbEZvcm1zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuZm9ybVNlbGVjdG9yKSk7XHJcblxyXG4vL2FwaSBrZXlzOlxyXG5leHBvcnQgY29uc3QgYXBpQ3JlZGVudGlhbHMgPSB7XHJcbiAgdG9rZW46IFwiMzM5MmE3YzMtNTM1OC00N2VlLTgxZmQtNjJmMzI3ODA2N2U1XCIsXHJcbiAgZ3JvdXBJRDogXCJjb2hvcnQtMy1lblwiXHJcbn07IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IGVkaXRBdmF0YXJCdXR0b24sIHZhbGlkYXRpb25Db25maWcsIGVkaXRQcm9maWxlQnV0dG9uLCBuZXdDYXJkUG9wdXBCdXR0b24sIGluaXRhbEZvcm1zIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxubGV0IGNhcmRTZWN0aW9uO1xyXG5jb25zdCBmb3Jtc1ZhbGlkYXRvcnMgPSB7fTtcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIzMzkyYTdjMy01MzU4LTQ3ZWUtODFmZC02MmYzMjc4MDY3ZTVcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbi8vY2FyZCBmdW5jdGlvbnNcclxuY29uc3QgcmVuZGVyQ2FyZCA9IChjYXJkKSA9PiB7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IGNyZWF0ZUNhcmQoY2FyZCk7XHJcbiAgY2FyZFNlY3Rpb24uYWRkSXRlbShuZXdDYXJkLmdlbmVyYXRlQ2FyZChwcm9maWxlLnVzZXJJZCkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcclxuICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluayk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGlkKSB7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oaWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGl0ZW0pIHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKGl0ZW0sIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlRGVsZXRlQ2xpY2ssIGhhbmRsZUxpa2VDbGljayk7XHJcbiAgICByZXR1cm4gY2FyZEVsZW1lbnRcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlTGlrZUNsaWNrKGNhcmQpIHtcclxuICBpZiAoY2FyZC5pc0xpa2VkID09PSB0cnVlKSB7XHJcbiAgICBhcGkucmVtb3ZlTGlrZShjYXJkLmdldElkKCkpXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBjYXJkLnJlbW92ZUxpa2UocmVzKTsgICBcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcblxyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIGFwaS5hZGRMaWtlKGNhcmQuZ2V0SWQoKSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGNhcmQuYWRkTGlrZShyZXMpO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuXHJcbi8vaW5pdGlhdGUgb2JqZWN0c1xyXG5cclxuXHJcbmNvbnN0IHByb2ZpbGUgPSBuZXcgVXNlckluZm8oeyBuYW1lU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2luZm8tbmFtZVwiLCBqb2JTZWxlY3RvcjogXCIucHJvZmlsZV9faW5mby1qb2JcIiwgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltZ1wiIH0pO1xyXG5cclxuY29uc3QgaW1hZ2VQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShcIi5pbWctcG9wdXBcIik7XHJcblxyXG5cclxuYXBpLmZldGNoSW5pdGlhbERhdGEoKVxyXG4gIC50aGVuKChbdXNlckluZm8sIGluaXRpYWxDYXJkXSkgPT4ge1xyXG4gICAgcHJvZmlsZS5zZXRVc2VySW5mbyh1c2VySW5mbyk7XHJcbiAgICBwcm9maWxlLnNldFVzZXJBdmF0YXIodXNlckluZm8pO1xyXG4gICAgcHJvZmlsZS51c2VySWQgPSB1c2VySW5mby5faWQ7XHJcbiAgICBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKHtcclxuICAgICAgaXRlbXM6IGluaXRpYWxDYXJkLCByZW5kZXJlcjogcmVuZGVyQ2FyZFxyXG4gICAgfSwgXCIuY2FyZHNcIik7XHJcblxyXG4gICAgY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuICB9KVxyXG4gIC5jYXRjaChlcnIgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcblxyXG5cclxuY29uc3QgZWRpdFByb2ZpbGVQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLnByb2ZpbGUtcG9wdXBcIiwgKGRhdGEpID0+IHtcclxuICBhcGkuZWRpdFVzZXJJbmZvcm1hdGlvbihkYXRhKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBwcm9maWxlLnNldFVzZXJJbmZvKHJlcyk7XHJcbiAgICAgIGVkaXRQcm9maWxlUG9wdXAuY2xvc2UoKTtcclxuICAgICAgZWRpdFByb2ZpbGVQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KChyZXMpID0+IGVkaXRQcm9maWxlUG9wdXAucmVuZGVyTG9hZGluZyhmYWxzZSkpXHJcbn0pO1xyXG5cclxuY29uc3QgZWRpdEF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIuYXZhdGFyLXBvcHVwXCIsIChkYXRhKSA9PiB7XHJcbiAgYXBpLmVkaXRQcm9maWxlUGljdHVyZShkYXRhKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBwcm9maWxlLnNldFVzZXJBdmF0YXIocmVzKTtcclxuICAgICAgZWRpdEF2YXRhclBvcHVwLmNsb3NlKCk7XHJcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KChyZXMpID0+IGVkaXRBdmF0YXJQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKSlcclxufSk7XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5jYXJkLXBvcHVwXCIsIChkYXRhKSA9PiB7XHJcbiAgYXBpLmFkZE5ld0NhcmQoeyBuYW1lOiBkYXRhLnRpdGxlLCBsaW5rOiBkYXRhLmxpbmsgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmVuZGVyQ2FyZChyZXMpO1xyXG4gICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhcImVyclwiLCBlcnIpO1xyXG4gICAgfSlcclxuICAgIC5maW5hbGx5KChyZXMpID0+IGFkZENhcmRQb3B1cC5yZW5kZXJMb2FkaW5nKGZhbHNlKSlcclxufSk7XHJcblxyXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoU3VibWl0KFwiLmRlbGV0ZS1wb3B1cFwiLCAoZGF0YSkgPT4ge1xyXG4gIGFwaS5kZWxldGVDYXJkKGRhdGEpXHJcbiAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGAjY2FyZC0ke2RhdGF9YCk7XHJcbiAgICAgIGNhcmQucmVtb3ZlKCk7XHJcbiAgICAgIGRlbGV0ZUNhcmRQb3B1cC5jbG9zZSgpO1xyXG4gICAgICBjb25zb2xlLmxvZyhcImNhcmQgcmVtb3ZlZFwiKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhcImVyclwiLCBlcnIpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuXHJcbi8vcHJvZmlsZSBwb3B1cCBvcGVuIGFuZCBwcmVwb3B1bGF0ZVxyXG5mdW5jdGlvbiBvcGVuUHJvZmlsZVBvcHVwKCkge1xyXG4gIGVkaXRQcm9maWxlUG9wdXAucHJlUG9wdWxhdGVGaWVsZHMocHJvZmlsZS5nZXRVc2VySW5mbygpKTtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxuICBmb3Jtc1ZhbGlkYXRvcnNbXCJwb3B1cF9fZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblByb2ZpbGVBdmF0YXIoKSB7XHJcbiAgZWRpdEF2YXRhclBvcHVwLnByZVBvcHVsYXRlRmllbGRzKHByb2ZpbGUuZ2V0VXNlckluZm8oKSk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxuICBmb3Jtc1ZhbGlkYXRvcnNbXCJhdmF0YXJfX2Zvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn1cclxuLy9zZXQgYnV0dG9uIGV2ZW50IGxpc3RlbmVyc1xyXG5uZXdDYXJkUG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG4gIGZvcm1zVmFsaWRhdG9yc1tcImNhcmQtcG9wdXBfX2Zvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Qcm9maWxlUG9wdXApO1xyXG5lZGl0QXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuUHJvZmlsZUF2YXRhcik7XHJcblxyXG5cclxuLy9pbml0aWF0ZSBmb3JtcyB2YWxpZGF0aW9uXHJcbmluaXRhbEZvcm1zLmZvckVhY2goZm9ybSA9PiB7XHJcbiAgY29uc3QgbmV3Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGZvcm0pO1xyXG4gIG5ld0Zvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIGZvcm1zVmFsaWRhdG9yc1tmb3JtLmlkXSA9IG5ld0Zvcm1WYWxpZGF0b3I7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm9ybWF0aW9uKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZWRpdFVzZXJJbmZvcm1hdGlvbih7IG5hbWUsIGpvYiB9KSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIGFib3V0OiBqb2JcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGFkZExpa2UoaWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgfVxyXG5cclxuICAgIHJlbW92ZUxpa2UoaWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgYWRkTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIGxpbms6IGxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIGRlbGV0ZUNhcmQoaWQpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzLyR7aWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgZWRpdFByb2ZpbGVQaWN0dXJlKHsgYXZhdGFyIH0pIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lL2F2YXRhcmAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgYXZhdGFyOiBhdmF0YXJcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIF9jaGVja1Jlc3BvbnNlKHJlcykge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgIH1cclxuXHJcbiAgICBfcmVxdWVzdCh1cmwsIG9wdGlvbnMpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2godXJsLCBvcHRpb25zKVxyXG4gICAgICAgICAgICAudGhlbih0aGlzLl9jaGVja1Jlc3BvbnNlKVxyXG4gICAgfVxyXG5cclxuICAgIGZldGNoSW5pdGlhbERhdGEoKSB7XHJcbiAgICAgICAgY29uc3QgdXNlckluZm8gPSB0aGlzLmdldFVzZXJJbmZvcm1hdGlvbigpO1xyXG4gICAgICAgIGNvbnN0IGluaXRpYWxDYXJkID0gdGhpcy5nZXRJbml0aWFsQ2FyZHMoKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UuYWxsKFt1c2VySW5mbywgaW5pdGlhbENhcmRdKTtcclxuICAgIH1cclxufVxyXG5cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gICAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XHJcbiAgICAgICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLl9hdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcclxuICAgICAgICB0aGlzLnVzZXJJZCA9IFwiXCI7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgam9iOiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXHJcbiAgICAgICAgICAgIGF2YXRhcjogdGhpcy5fYXZhdGFyLnNyY1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgICAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSBhYm91dDtcclxuICAgIH1cclxuXHJcbiAgICBzZXRVc2VyQXZhdGFyKHsgYXZhdGFyIH0pIHtcclxuICAgICAgICB0aGlzLl9hdmF0YXIuc3JjID0gYXZhdGFyO1xyXG4gICAgfVxyXG5cclxufSIsImltcG9ydCBQb3B1cCBmcm9tICcuL1BvcHVwLmpzJztcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gICAgY29uc3RydWN0b3IocG9wdXApIHtcclxuICAgICAgICBzdXBlcihwb3B1cCk7XHJcbiAgICAgICAgdGhpcy5fdGl0bGUgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmltZy1wb3B1cF9fdGl0bGVcIik7XHJcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmltZy1wb3B1cF9faW1nXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIG9wZW4obmFtZSwgbGluaykge1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICAgICAgdGhpcy5fdGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhTdWJtaXQgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cCwgc3VibWl0Q2FsbGJhY2tGdW5jdGlvbikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBzdWJtaXRDYWxsYmFja0Z1bmN0aW9uO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKFwiLmZvcm1fX3N1Ym1pdFwiKTtcclxuICAgIH1cclxuXHJcbiAgICBfb25TdWJtaXQgPSAoZSkgPT4ge1xyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCh0aGlzLmltZ0lkKTtcclxuICAgIH07XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9vblN1Ym1pdCk7XHJcbiAgICB9XHJcblxyXG4gICAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9vblN1Ym1pdCk7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihpZCkge1xyXG4gICAgICAgIHRoaXMuaW1nSWQgPSBpZDtcclxuICAgICAgICBzdXBlci5vcGVuKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlllc1wiO1xyXG4gICAgfVxyXG5cclxufSJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJkYXRhIiwidGVtcGxhdGVTZWxlY3RvciIsImhhbmRsZUNhcmRDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwidGhpcyIsIl90aXRsZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfdGVtcGxhdGVTZWxlY3RvciIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX2xpa2VzIiwibGlrZXMiLCJfb3duZXJJZCIsIm93bmVyIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9lbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImUiLCJfc2V0TGlrZUljb25PbiIsImNsYXNzTGlzdCIsImFkZCIsIl9zZXRMaWtlSWNvbk9mZiIsInJlbW92ZSIsImFkZExpa2UiLCJyZXMiLCJpc0xpa2VkIiwiX2VkaXRMaWtlQ291bnRlciIsInJlbW92ZUxpa2UiLCJfZGVsZXRlQ2FyZCIsIl9oYW5kbGVJbml0aWFsTGlrZXMiLCJpZCIsInRleHRDb250ZW50IiwibGVuZ3RoIiwiZ2V0SWQiLCJnZW5lcmF0ZUNhcmQiLCJzb21lIiwibGlrZSIsImNhcmRJbWciLCJjYXJkVGl0bGUiLCJzcmMiLCJhbHQiLCJTZWN0aW9uIiwiX3JlZiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsImZvckVhY2giLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtIiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9kaXNhYmxlQnV0dG9uIiwiX2J1dHRvbkVsZW1lbnQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dCIsImVuYWJsZVZhbGlkYXRpb24iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiUG9wdXAiLCJwb3B1cCIsIl9wb3B1cCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJjbG9zZSIsIl9yZW1vdmVFdmVudExpc3RlbmVycyIsIl9oYW5kbGVFc2NDbG9zZSIsImV2dCIsImtleSIsIl9oYW5kbGVNb3VzZUNsaWNrQ2xvc2UiLCJ0YXJnZXQiLCJjb250YWlucyIsIl9oYW5kbGVCdG5DbGlja0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJzdWJtaXRDYWxsYmFja0Z1bmN0aW9uIiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX2Zvcm0iLCJfZm9ybVN1Ym1pdEJ1dHRvbiIsIl9mb3JtU3VibWl0QnV0dG9uVGV4dCIsIl9pbnB1dHMiLCJBcnJheSIsImZyb20iLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ2YWx1ZXMiLCJ2YWx1ZSIsIl9vblN1Ym1pdCIsInByZXZlbnREZWZhdWx0IiwicmVuZGVyTG9hZGluZyIsInJlc2V0IiwiaXNMb2FkaW5nIiwibG9hZGluZ1RleHQiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJwcmVQb3B1bGF0ZUZpZWxkcyIsInZhbGlkYXRpb25Db25maWciLCJmb3JtU2VsZWN0b3IiLCJlZGl0UHJvZmlsZUJ1dHRvbiIsIm5ld0NhcmRQb3B1cEJ1dHRvbiIsImVkaXRBdmF0YXJCdXR0b24iLCJpbml0YWxGb3JtcyIsImNhcmRTZWN0aW9uIiwiZm9ybXNWYWxpZGF0b3JzIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJnZXRJbml0aWFsQ2FyZHMiLCJfcmVxdWVzdCIsImdldFVzZXJJbmZvcm1hdGlvbiIsImVkaXRVc2VySW5mb3JtYXRpb24iLCJfcmVmMiIsImpvYiIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGROZXdDYXJkIiwiX3JlZjMiLCJkZWxldGVDYXJkIiwiZWRpdFByb2ZpbGVQaWN0dXJlIiwiX3JlZjQiLCJhdmF0YXIiLCJfY2hlY2tSZXNwb25zZSIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJ0aGVuIiwiZmV0Y2hJbml0aWFsRGF0YSIsInVzZXJJbmZvIiwiaW5pdGlhbENhcmQiLCJhbGwiLCJhdXRob3JpemF0aW9uIiwicmVuZGVyQ2FyZCIsImNhcmQiLCJuZXdDYXJkIiwiaGFuZGxlSW1hZ2VDbGljayIsInByb2ZpbGUiLCJ1c2VySWQiLCJpbWFnZVBvcHVwIiwiZGVsZXRlQ2FyZFBvcHVwIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwibG9nIiwibmFtZVNlbGVjdG9yIiwiam9iU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lIiwiX2pvYiIsIl9hdmF0YXIiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwic2V0VXNlckF2YXRhciIsIl9pbWFnZSIsImVkaXRQcm9maWxlUG9wdXAiLCJmaW5hbGx5IiwiZWRpdEF2YXRhclBvcHVwIiwiYWRkQ2FyZFBvcHVwIiwidGl0bGUiLCJfc3VibWl0QnV0dG9uIiwiaW1nSWQiLCJuZXdGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==