!function(){"use strict";class e{constructor(e,t,s,i,r){this._title=e.name,this._link=e.link,this._id=e._id,this._templateSelector=t,this._handleCardClick=s,this._handleDeleteClick=i,this._handleLikeClick=r,this._likes=e.likes,this._ownerId=e.owner._id}_getTemplate(){return document.querySelector(this._templateSelector).content.querySelector(".card").cloneNode(!0)}_setEventListeners(){this._element.querySelector(".card__icon-bin").addEventListener("click",(()=>{this._handleDeleteClick(this._id)})),this._element.querySelector(".card__icon").addEventListener("click",(e=>{this._handleLikeClick()})),this._element.querySelector(".card__img").addEventListener("click",(e=>{this._handleCardClick(this._title,this._link)}))}_setLikeOn(){this._element.querySelector(".card__icon").classList.add("card__icon_active")}_setLikeOff(){this._element.querySelector(".card__icon").classList.remove("card__icon_active")}_deleteCard(){this._element.remove(),this._element=null}_handleInitialLikes(e){this._editLikeCounter(e),this._isLiked&&this._setLikeOn()}_editLikeCounter(){this._element.querySelector(".card__likes-counter").textContent=this._likes.length}generateCard(e){this._element=this._getTemplate(),this._isLiked=this._likes.some((t=>t._id===e));const t=this._element.querySelector(".card__img"),s=this._element.querySelector(".card__title");return this._element.id=`card-${this._id}`,t.src=this._link,t.alt=`Photo of ${this._title}`,s.textContent=this._title,this._handleInitialLikes(e),this._setEventListeners(),this._ownerId!==e&&this._element.querySelector(".card__icon-bin").remove(),this._element}}class t{constructor(e,t){let{items:s,renderer:i}=e;this._items=s,this._renderer=i,this._container=document.querySelector(t)}addItem(e){this._container.prepend(e)}renderItems(){this._items.forEach(this._renderer)}}class s{constructor(e,t){this._settings=e,this._formElement=t}_showInputError(e,t){const s=this._formElement.querySelector(`.${e.id}-error`);e.classList.add(this._settings.inputErrorClass),s.textContent=t,s.classList.add(this._settings.errorClass)}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_hideInputError(e){const t=this._formElement.querySelector(`.${e.id}-error`);e.classList.remove(this._settings.inputErrorClass),t.classList.remove(this._settings.errorClass),t.textContent="."}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}_toggleButtonState(){this._hasInvalidInput()?this._disableButton():(this._buttonElement.classList.remove(this._settings.inactiveButtonClass),this._buttonElement.disabled=!1)}_disableButton(){this._buttonElement.classList.add(this._settings.inactiveButtonClass),this._buttonElement.disabled=!0}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}resetValidation(){this._inputList.forEach((e=>{this._hideInputError(e)})),this._disableButton()}enableValidation(){this._inputList=[...this._formElement.querySelectorAll(this._settings.inputSelector)],this._buttonElement=this._formElement.querySelector(this._settings.submitButtonSelector),this._setEventListeners()}}class i{constructor(e){this._popup=document.querySelector(e),this._closeButton=this._popup.querySelector(".popup__close-btn")}open(){this._popup.classList.add("popup_opened"),this._setEventListeners()}close(){this._popup.classList.remove("popup_opened"),this._removeEventListeners()}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_handleMouseClickClose=e=>{e.target.classList.contains("popup_opened")&&this.close()};_handleBtnClickClose=e=>{this.close()};_setEventListeners(){document.addEventListener("keydown",this._handleEscClose),document.addEventListener("mousedown",this._handleMouseClickClose),this._closeButton.addEventListener("click",this._handleBtnClickClose)}_removeEventListeners(){document.removeEventListener("keydown",this._handleEscClose),document.removeEventListener("mousedown",this._handleMouseClickClose),this._closeButton.removeEventListener("click",this._handleBtnClickClose)}}class r extends i{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".form"),this._formSubmitButton=this._form.querySelector(".form__submit"),this._originalButtonText=this._formSubmitButton.textContent,this._inputs=Array.from(this._form.querySelectorAll(".form__input"))}_getInputValues(){const e={};return this._inputs.forEach((t=>{e[t.name]=t.value})),e}_onSubmit=e=>{e.preventDefault(),this._formSubmitButton.textContent="Saving...",this._handleSubmit(this._getInputValues())};_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",this._onSubmit)}_removeEventListeners(){super._removeEventListeners(),this._form.removeEventListener("submit",this._onSubmit)}close(){super.close(),this._formSubmitButton.textContent=this._originalButtonText,this._form.reset()}prePopulateFields(e){this._inputs.forEach((t=>{t.value=e[t.name]}))}}const n={formSelector:".form",inputSelector:".form__input",submitButtonSelector:".form__submit",inactiveButtonClass:"popup__field-submit_inactive",inputErrorClass:"form__input-error",errorClass:"popup__input-error_active"},o=document.querySelector(".profile__info-btn"),l=document.querySelector(".profile__add-btn"),a=document.querySelector(".profile__img-overlay"),h=(document.querySelector(".cards"),Array.from(document.querySelectorAll(n.formSelector)));let c;const _={},d=new class{constructor(e){let{baseUrl:t,headers:s}=e;this.baseUrl=t,this.headers=s}getInitialCards(){return fetch(`${this.baseUrl}/cards`,{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInformation(){return fetch(`${this.baseUrl}/users/me`,{headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editUserInformation(e){let{name:t,job:s}=e;return fetch(`${this.baseUrl}/users/me`,{method:"PATCH",headers:this.headers,body:JSON.stringify({name:t,about:s})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addLike(e){return fetch(`${this.baseUrl}/cards/likes/${e}`,{method:"PUT",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}removeLike(e){return fetch(`${this.baseUrl}/cards/likes/${e}`,{method:"DELETE",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){let{name:t,link:s}=e;return fetch(`${this.baseUrl}/cards`,{method:"POST",headers:this.headers,body:JSON.stringify({name:t,link:s})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`${this.baseUrl}/cards/${e}`,{method:"DELETE",headers:this.headers}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}editProfilePicture(e){let{avatar:t}=e;return fetch(`${this.baseUrl}/users/me/avatar`,{method:"PATCH",headers:this.headers,body:JSON.stringify({avatar:t})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}fetchInitialData(){const e=this.getUserInformation(),t=this.getInitialCards();return Promise.all([e,t])}}({baseUrl:"https://around.nomoreparties.co/v1/cohort-3-en",headers:{authorization:"3392a7c3-5358-47ee-81fd-62f3278067e5","Content-Type":"application/json"}}),u=t=>{const s=new e(t,"#card-template",m,p,f);c.addItem(s.generateCard(v.userId))};function m(e,t){k.open(e,t)}function p(e){b.open(e)}function f(){!0===this._isLiked?d.removeLike(this._id).then((e=>{this._setLikeOff(),this._isLiked=!1,this._likes=e.likes,this._editLikeCounter()})).catch((e=>console.log(e))):d.addLike(this._id).then((e=>{this._setLikeOn(),this._isLiked=!0,this._likes=e.likes,this._editLikeCounter()})).catch((e=>console.log(e)))}const v=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:i}=e;this._name=document.querySelector(t),this._job=document.querySelector(s),this._avatar=document.querySelector(i),this.userId=""}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent,avatar:this._avatar.src}}setUserInfo(e){let{name:t,about:s}=e;this._name.textContent=t,this._job.textContent=s}setUserAvatar(e){let{avatar:t}=e;this._avatar.src=t}}({nameSelector:".profile__info-name",jobSelector:".profile__info-job",avatarSelector:".profile__img"}),k=new class extends i{constructor(e){super(e),this._title=this._popup.querySelector(".img-popup__title"),this._image=this._popup.querySelector(".img-popup__img")}open(e,t){super.open(),this._image.src=t,this._image.alt=e,this._title.textContent=e}}(".img-popup");d.fetchInitialData().then((e=>{let[s,i]=e;v.setUserInfo(s),v.setUserAvatar(s),v.userId=s._id,c=new t({items:i,renderer:u},".cards"),c.renderItems()})).catch((e=>console.log(e)));const E=new r(".profile-popup",(e=>{d.editUserInformation(e).then((e=>{console.log(e),v.setUserInfo(e),E.close()}))})),L=new r(".avatar-popup",(e=>{console.log(e),d.editProfilePicture(e).then((e=>{console.log(e),v.setUserAvatar(e),L.close()})).catch((e=>console.log(e)))})),S=new r(".card-popup",(e=>{d.addNewCard({name:e.title,link:e.link}).then((e=>{u(e),S.close()})).catch((e=>{console.log("err",e)}))})),b=new class extends i{constructor(e,t){super(e),this._handleSubmit=t,this._form=this._popup.querySelector(".form"),this._submitButton=this._form.querySelector(".form__submit")}_onSubmit=e=>{e.preventDefault(),this._submitButton.textContent="Saving...",this._handleSubmit(this.imgId)};_setEventListeners(){super._setEventListeners(),this._form.addEventListener("submit",this._onSubmit)}open(e){this.imgId=e,super.open()}close(){super.close(),this._submitButton.textContent="Yes"}}(".delete-popup",(e=>{d.deleteCard(e).then((t=>{document.querySelector(`#card-${e}`).remove(),b.close(),console.log("card removed")})).catch((e=>{console.log("err",e)}))}));l.addEventListener("click",(()=>{S.open(),_["card-popup__form"].resetValidation()})),o.addEventListener("click",(function(){E.prePopulateFields(v.getUserInfo()),E.open(),_.popup__form.resetValidation()})),a.addEventListener("click",(function(){L.prePopulateFields(v.getUserInfo()),L.open(),_.avatar__form.resetValidation()})),h.forEach((e=>{const t=new s(n,e);t.enableValidation(),_[e.id]=t}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsIm1hcHBpbmdzIjoieUJBQWUsTUFBTUEsRUFDakJDLFlBQVlDLEVBQU1DLEVBQWtCQyxFQUFpQkMsRUFBbUJDLEdBQ3BFQyxLQUFLQyxPQUFTTixFQUFLTyxLQUNuQkYsS0FBS0csTUFBUVIsRUFBS1MsS0FDbEJKLEtBQUtLLElBQU1WLEVBQUtVLElBQ2hCTCxLQUFLTSxrQkFBb0JWLEVBQ3pCSSxLQUFLTyxpQkFBbUJWLEVBQ3hCRyxLQUFLUSxtQkFBcUJWLEVBQzFCRSxLQUFLUyxpQkFBbUJWLEVBQ3hCQyxLQUFLVSxPQUFTZixFQUFLZ0IsTUFDbkJYLEtBQUtZLFNBQVdqQixFQUFLa0IsTUFBTVIsR0FDL0IsQ0FFQVMsZUFFSSxPQURxQkMsU0FBU0MsY0FBY2hCLEtBQUtNLG1CQUFtQlcsUUFBUUQsY0FBYyxTQUFTRSxXQUFVLEVBRWpILENBRUFDLHFCQUN5Qm5CLEtBQUtvQixTQUFTSixjQUFjLG1CQUNwQ0ssaUJBQWlCLFNBQVMsS0FDbkNyQixLQUFLUSxtQkFBbUJSLEtBQUtLLElBQUksSUFJckNMLEtBQUtvQixTQUFTSixjQUFjLGVBQWVLLGlCQUFpQixTQUFVQyxJQUNsRXRCLEtBQUtTLGtCQUFrQixJQUczQlQsS0FBS29CLFNBQVNKLGNBQWMsY0FBY0ssaUJBQWlCLFNBQVVDLElBQ2pFdEIsS0FBS08saUJBQWlCUCxLQUFLQyxPQUFRRCxLQUFLRyxNQUFNLEdBR3RELENBRUFvQixhQUVJdkIsS0FBS29CLFNBQVNKLGNBQWMsZUFBZVEsVUFBVUMsSUFBSSxvQkFDN0QsQ0FFQUMsY0FFSTFCLEtBQUtvQixTQUFTSixjQUFjLGVBQWVRLFVBQVVHLE9BQU8sb0JBQ2hFLENBRUFDLGNBQ0k1QixLQUFLb0IsU0FBU08sU0FDZDNCLEtBQUtvQixTQUFXLElBQ3BCLENBR0FTLG9CQUFvQkMsR0FDaEI5QixLQUFLK0IsaUJBQWlCRCxHQUVsQjlCLEtBQUtnQyxVQUNMaEMsS0FBS3VCLFlBRWIsQ0FFQVEsbUJBQ3NCL0IsS0FBS29CLFNBQVNKLGNBQWMsd0JBQ3BDaUIsWUFBY2pDLEtBQUtVLE9BQU93QixNQUN4QyxDQUVBQyxhQUFhTCxHQUNUOUIsS0FBS29CLFNBQVdwQixLQUFLYyxlQUNyQmQsS0FBS2dDLFNBQVdoQyxLQUFLVSxPQUFPMEIsTUFBTUMsR0FBU0EsRUFBS2hDLE1BQVF5QixJQUV4RCxNQUFNUSxFQUFVdEMsS0FBS29CLFNBQVNKLGNBQWMsY0FDdEN1QixFQUFZdkMsS0FBS29CLFNBQVNKLGNBQWMsZ0JBaUI5QyxPQWZBaEIsS0FBS29CLFNBQVNVLEdBQU8sUUFBTzlCLEtBQUtLLE1BRWpDaUMsRUFBUUUsSUFBTXhDLEtBQUtHLE1BQ25CbUMsRUFBUUcsSUFBTyxZQUFXekMsS0FBS0MsU0FDL0JzQyxFQUFVTixZQUFjakMsS0FBS0MsT0FFN0JELEtBQUs2QixvQkFBb0JDLEdBQ3pCOUIsS0FBS21CLHFCQUVEbkIsS0FBS1ksV0FBYWtCLEdBQ0c5QixLQUFLb0IsU0FBU0osY0FBYyxtQkFDcENXLFNBSVYzQixLQUFLb0IsUUFFaEIsRUN4RlcsTUFBTXNCLEVBQ2pCaEQsWUFBV2lELEVBQXNCQyxHQUFtQixJQUF4QyxNQUFFQyxFQUFLLFNBQUVDLEdBQVVILEVBQzNCM0MsS0FBSytDLE9BQVNGLEVBQ2Q3QyxLQUFLZ0QsVUFBWUYsRUFDakI5QyxLQUFLaUQsV0FBYWxDLFNBQVNDLGNBQWM0QixFQUM3QyxDQUVBTSxRQUFRQyxHQUNKbkQsS0FBS2lELFdBQVdHLFFBQVFELEVBQzVCLENBRUFFLGNBQ0lyRCxLQUFLK0MsT0FBT08sUUFBUXRELEtBQUtnRCxVQUM3QixFQ2JXLE1BQU1PLEVBQ25CN0QsWUFBWThELEVBQVVDLEdBQ3BCekQsS0FBSzBELFVBQVlGLEVBQ2pCeEQsS0FBSzJELGFBQWVGLENBQ3RCLENBRUFHLGdCQUFnQkMsRUFBY0MsR0FDNUIsTUFBTUMsRUFBZS9ELEtBQUsyRCxhQUFhM0MsY0FBZSxJQUFHNkMsRUFBYS9CLFlBQ3RFK0IsRUFBYXJDLFVBQVVDLElBQUl6QixLQUFLMEQsVUFBVU0saUJBQzFDRCxFQUFhOUIsWUFBYzZCLEVBQzNCQyxFQUFhdkMsVUFBVUMsSUFBSXpCLEtBQUswRCxVQUFVTyxXQUU1QyxDQUVBQyxtQkFDRSxPQUFPbEUsS0FBS21FLFdBQVcvQixNQUFNeUIsSUFBa0JBLEVBQWFPLFNBQVNDLE9BQ3ZFLENBRUFDLGdCQUFnQlQsR0FDZCxNQUFNRSxFQUFlL0QsS0FBSzJELGFBQWEzQyxjQUFlLElBQUc2QyxFQUFhL0IsWUFDdEUrQixFQUFhckMsVUFBVUcsT0FBTzNCLEtBQUswRCxVQUFVTSxpQkFDN0NELEVBQWF2QyxVQUFVRyxPQUFPM0IsS0FBSzBELFVBQVVPLFlBQzdDRixFQUFhOUIsWUFBYyxHQUM3QixDQUVBc0Msb0JBQW9CVixHQUNkQSxFQUFhTyxTQUFTQyxNQUN4QnJFLEtBQUtzRSxnQkFBZ0JULEdBRXJCN0QsS0FBSzRELGdCQUFnQkMsRUFBY0EsRUFBYVcsa0JBRXBELENBRUFDLHFCQUNNekUsS0FBS2tFLG1CQUNQbEUsS0FBSzBFLGtCQUVMMUUsS0FBSzJFLGVBQWVuRCxVQUFVRyxPQUFPM0IsS0FBSzBELFVBQVVrQixxQkFDcEQ1RSxLQUFLMkUsZUFBZUUsVUFBVyxFQUduQyxDQUVBSCxpQkFDRTFFLEtBQUsyRSxlQUFlbkQsVUFBVUMsSUFBSXpCLEtBQUswRCxVQUFVa0IscUJBQ2pENUUsS0FBSzJFLGVBQWVFLFVBQVcsQ0FDakMsQ0FFQTFELHFCQUNFbkIsS0FBS21FLFdBQVdiLFNBQVNPLElBQ3ZCQSxFQUFheEMsaUJBQWlCLFNBQVVDLElBQ3RDdEIsS0FBS3VFLG9CQUFvQlYsR0FDekI3RCxLQUFLeUUsb0JBQW9CLEdBQ3pCLEdBRU4sQ0FFQUssa0JBQ0U5RSxLQUFLbUUsV0FBV2IsU0FBUXlCLElBQ3RCL0UsS0FBS3NFLGdCQUFnQlMsRUFBTSxJQUU3Qi9FLEtBQUswRSxnQkFDUCxDQUVBTSxtQkFDRWhGLEtBQUttRSxXQUFhLElBQUluRSxLQUFLMkQsYUFBYXNCLGlCQUFpQmpGLEtBQUswRCxVQUFVd0IsZ0JBQ3hFbEYsS0FBSzJFLGVBQWlCM0UsS0FBSzJELGFBQWEzQyxjQUFjaEIsS0FBSzBELFVBQVV5QixzQkFDckVuRixLQUFLbUIsb0JBQ1AsRUNwRWEsTUFBTWlFLEVBQ2pCMUYsWUFBWTJGLEdBQ1JyRixLQUFLc0YsT0FBU3ZFLFNBQVNDLGNBQWNxRSxHQUNyQ3JGLEtBQUt1RixhQUFldkYsS0FBS3NGLE9BQU90RSxjQUFjLG9CQUNsRCxDQUVBd0UsT0FDSXhGLEtBQUtzRixPQUFPOUQsVUFBVUMsSUFBSSxnQkFDMUJ6QixLQUFLbUIsb0JBQ1QsQ0FFQXNFLFFBQ0l6RixLQUFLc0YsT0FBTzlELFVBQVVHLE9BQU8sZ0JBQzdCM0IsS0FBSzBGLHVCQUNULENBRUFDLGdCQUFtQkMsSUFDQyxXQUFaQSxFQUFJQyxLQUNKN0YsS0FBS3lGLE9BQ1QsRUFHSkssdUJBQTBCRixJQUNsQkEsRUFBSUcsT0FBT3ZFLFVBQVV3RSxTQUFTLGlCQUM5QmhHLEtBQUt5RixPQUNULEVBR0pRLHFCQUF3QkwsSUFDcEI1RixLQUFLeUYsT0FBTyxFQUdoQnRFLHFCQUNJSixTQUFTTSxpQkFBaUIsVUFBV3JCLEtBQUsyRixpQkFDMUM1RSxTQUFTTSxpQkFBaUIsWUFBYXJCLEtBQUs4Rix3QkFDNUM5RixLQUFLdUYsYUFBYWxFLGlCQUFpQixRQUFTckIsS0FBS2lHLHFCQUNyRCxDQUVBUCx3QkFDSTNFLFNBQVNtRixvQkFBb0IsVUFBV2xHLEtBQUsyRixpQkFDN0M1RSxTQUFTbUYsb0JBQW9CLFlBQWFsRyxLQUFLOEYsd0JBQy9DOUYsS0FBS3VGLGFBQWFXLG9CQUFvQixRQUFTbEcsS0FBS2lHLHFCQUN4RCxFQ3hDVyxNQUFNRSxVQUFzQmYsRUFDdkMxRixZQUFZMkYsRUFBT2UsR0FDZkMsTUFBTWhCLEdBQ05yRixLQUFLc0csY0FBZ0JGLEVBRXJCcEcsS0FBS3VHLE1BQVF2RyxLQUFLc0YsT0FBT3RFLGNBQWMsU0FDdkNoQixLQUFLd0csa0JBQW9CeEcsS0FBS3VHLE1BQU12RixjQUFjLGlCQUNsRGhCLEtBQUt5RyxvQkFBc0J6RyxLQUFLd0csa0JBQWtCdkUsWUFDbERqQyxLQUFLMEcsUUFBVUMsTUFBTUMsS0FBSzVHLEtBQUt1RyxNQUFNdEIsaUJBSmYsZ0JBSzFCLENBRUE0QixrQkFDSSxNQUFNQyxFQUFTLENBQUMsRUFJaEIsT0FIQTlHLEtBQUswRyxRQUFRcEQsU0FBU3lCLElBQ2xCK0IsRUFBTy9CLEVBQU03RSxNQUFRNkUsRUFBTWdDLEtBQUssSUFFN0JELENBQ1gsQ0FFQUUsVUFBYTFGLElBQ1RBLEVBQUUyRixpQkFDRmpILEtBQUt3RyxrQkFBa0J2RSxZQUFjLFlBQ3JDakMsS0FBS3NHLGNBQWN0RyxLQUFLNkcsa0JBQWtCLEVBRzlDMUYscUJBQ0lrRixNQUFNbEYscUJBQ05uQixLQUFLdUcsTUFBTWxGLGlCQUFpQixTQUFVckIsS0FBS2dILFVBQy9DLENBRUF0Qix3QkFDSVcsTUFBTVgsd0JBQ04xRixLQUFLdUcsTUFBTUwsb0JBQW9CLFNBQVVsRyxLQUFLZ0gsVUFDbEQsQ0FFQXZCLFFBQ0lZLE1BQU1aLFFBQ056RixLQUFLd0csa0JBQWtCdkUsWUFBY2pDLEtBQUt5RyxvQkFDMUN6RyxLQUFLdUcsTUFBTVcsT0FDZixDQUVBQyxrQkFBa0J4SCxHQUNkSyxLQUFLMEcsUUFBUXBELFNBQVN5QixJQUNsQkEsRUFBTWdDLE1BQVFwSCxFQUFLb0YsRUFBTTdFLEtBQUssR0FFdEMsRUM3Q0csTUFBTWtILEVBQW1CLENBQzlCQyxhQUFjLFFBQ2RuQyxjQUFlLGVBQ2ZDLHFCQUFzQixnQkFDdEJQLG9CQUFxQiwrQkFDckJaLGdCQUFpQixvQkFDakJDLFdBQVksNkJBSURxRCxFQUFvQnZHLFNBQVNDLGNBQWMsc0JBQzNDdUcsRUFBcUJ4RyxTQUFTQyxjQUFjLHFCQUM1Q3dHLEVBQW1CekcsU0FBU0MsY0FBYyx5QkFFMUN5RyxHQURpQjFHLFNBQVNDLGNBQWMsVUFDMUIyRixNQUFNQyxLQUFLN0YsU0FBU2tFLGlCQUFpQm1DLEVBQWlCQyxnQkNMakYsSUFBSUssRUFDSixNQUFNQyxFQUFrQixDQUFDLEVBQ25CQyxFQUFNLElDYkcsTUFDWGxJLFlBQVdpRCxHQUF1QixJQUF0QixRQUFFa0YsRUFBTyxRQUFFQyxHQUFTbkYsRUFDNUIzQyxLQUFLNkgsUUFBVUEsRUFDZjdILEtBQUs4SCxRQUFVQSxDQUNuQixDQUVBQyxrQkFDSSxPQUFPQyxNQUFPLEdBQUVoSSxLQUFLNkgsZ0JBQWlCLENBQ2xDQyxRQUFTOUgsS0FBSzhILFVBRWJHLE1BQUtDLEdBQ0VBLEVBQUlDLEdBQ0dELEVBQUlFLE9BRVJDLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssV0FFaEQsQ0FFQUMscUJBQ0ksT0FBT1IsTUFBTyxHQUFFaEksS0FBSzZILG1CQUFvQixDQUNyQ0MsUUFBUzlILEtBQUs4SCxVQUViRyxNQUFLQyxHQUNFQSxFQUFJQyxHQUNHRCxFQUFJRSxPQUVSQyxRQUFRQyxPQUFRLFVBQVNKLEVBQUlLLFdBRWhELENBRUFFLG9CQUFtQkMsR0FBZ0IsSUFBZixLQUFFeEksRUFBSSxJQUFFeUksR0FBS0QsRUFDN0IsT0FBT1YsTUFBTyxHQUFFaEksS0FBSzZILG1CQUFvQixDQUNyQ2UsT0FBUSxRQUNSZCxRQUFTOUgsS0FBSzhILFFBQ2RlLEtBQU1DLEtBQUtDLFVBQVUsQ0FDakI3SSxLQUFNQSxFQUNOOEksTUFBT0wsTUFHVlYsTUFBS0MsR0FDRUEsRUFBSUMsR0FDR0QsRUFBSUUsT0FFUkMsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxXQUVoRCxDQUVBVSxRQUFRbkgsR0FDSixPQUFPa0csTUFBTyxHQUFFaEksS0FBSzZILHVCQUF1Qi9GLElBQU0sQ0FDOUM4RyxPQUFRLE1BQ1JkLFFBQVM5SCxLQUFLOEgsVUFFYkcsTUFBS0MsR0FDRUEsRUFBSUMsR0FDR0QsRUFBSUUsT0FFUkMsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxXQUdoRCxDQUVBVyxXQUFXcEgsR0FDUCxPQUFPa0csTUFBTyxHQUFFaEksS0FBSzZILHVCQUF1Qi9GLElBQU0sQ0FDOUM4RyxPQUFRLFNBQ1JkLFFBQVM5SCxLQUFLOEgsVUFFYkcsTUFBS0MsR0FDRUEsRUFBSUMsR0FDR0QsRUFBSUUsT0FFUkMsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxXQUdoRCxDQUVBWSxXQUFVQyxHQUFpQixJQUFoQixLQUFFbEosRUFBSSxLQUFFRSxHQUFNZ0osRUFDckIsT0FBT3BCLE1BQU8sR0FBRWhJLEtBQUs2SCxnQkFBaUIsQ0FDbENlLE9BQVEsT0FDUmQsUUFBUzlILEtBQUs4SCxRQUNkZSxLQUFNQyxLQUFLQyxVQUFVLENBQ2pCN0ksS0FBTUEsRUFDTkUsS0FBTUEsTUFHVDZILE1BQUtDLEdBQ0VBLEVBQUlDLEdBQ0dELEVBQUlFLE9BRVJDLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssV0FFaEQsQ0FFQWMsV0FBV3ZILEdBQ1AsT0FBT2tHLE1BQU8sR0FBRWhJLEtBQUs2SCxpQkFBaUIvRixJQUFNLENBQ3hDOEcsT0FBUSxTQUNSZCxRQUFTOUgsS0FBSzhILFVBRWJHLE1BQUtDLEdBQ0VBLEVBQUlDLEdBQ0dELEVBQUlFLE9BRVJDLFFBQVFDLE9BQVEsVUFBU0osRUFBSUssV0FFaEQsQ0FFQWUsbUJBQWtCQyxHQUFhLElBQVosT0FBRUMsR0FBUUQsRUFDekIsT0FBT3ZCLE1BQU8sR0FBRWhJLEtBQUs2SCwwQkFBMkIsQ0FDNUNlLE9BQVEsUUFDUmQsUUFBUzlILEtBQUs4SCxRQUNkZSxLQUFNQyxLQUFLQyxVQUFVLENBQ2pCUyxPQUFRQSxNQUdYdkIsTUFBS0MsR0FDRUEsRUFBSUMsR0FDR0QsRUFBSUUsT0FFUkMsUUFBUUMsT0FBUSxVQUFTSixFQUFJSyxXQUVoRCxDQUVBa0IsbUJBQ0ksTUFBTUMsRUFBVzFKLEtBQUt3SSxxQkFDaEJtQixFQUFjM0osS0FBSytILGtCQUV6QixPQUFPTSxRQUFRdUIsSUFBSSxDQUFDRixFQUFVQyxHQUNsQyxHRGpIZ0IsQ0FDbEI5QixRQUFTLGlEQUNUQyxRQUFTLENBQ1ArQixjQUFlLHVDQUNmLGVBQWdCLHNCQUtkQyxFQUFjQyxJQUNsQixNQUFNQyxFQUFVLElBQUl2SyxFQUFLc0ssRUFBTSxpQkFBa0JFLEVBQWtCbkssRUFBbUJDLEdBQ3RGMkgsRUFBTXhFLFFBQVE4RyxFQUFRN0gsYUFBYStILEVBQVFDLFFBQVEsRUFHckQsU0FBU0YsRUFBaUIvSixFQUFNRSxHQUM5QmdLLEVBQVc1RSxLQUFLdEYsRUFBTUUsRUFDeEIsQ0FFQSxTQUFTTixFQUFrQmdDLEdBQ3pCdUksRUFBZ0I3RSxLQUFLMUQsRUFDdkIsQ0FFQSxTQUFTL0IsS0FDZSxJQUFsQkMsS0FBS2dDLFNBQ1A0RixFQUFJc0IsV0FBV2xKLEtBQUtLLEtBQ2pCNEgsTUFBTUMsSUFDTGxJLEtBQUswQixjQUNMMUIsS0FBS2dDLFVBQVcsRUFDaEJoQyxLQUFLVSxPQUFTd0gsRUFBSXZILE1BQ2xCWCxLQUFLK0Isa0JBQWtCLElBRXhCdUksT0FBT0MsR0FBUUMsUUFBUUMsSUFBSUYsS0FJOUIzQyxFQUFJcUIsUUFBUWpKLEtBQUtLLEtBQ2Q0SCxNQUFNQyxJQUNMbEksS0FBS3VCLGFBQ0x2QixLQUFLZ0MsVUFBVyxFQUNoQmhDLEtBQUtVLE9BQVN3SCxFQUFJdkgsTUFDbEJYLEtBQUsrQixrQkFBa0IsSUFFeEJ1SSxPQUFPQyxHQUFRQyxRQUFRQyxJQUFJRixJQUdsQyxDQU1BLE1BQU1MLEVBQVUsSUVoRUQsTUFDWHhLLFlBQVdpRCxHQUFnRCxJQUEvQyxhQUFFK0gsRUFBWSxZQUFFQyxFQUFXLGVBQUVDLEdBQWdCakksRUFDckQzQyxLQUFLNkssTUFBUTlKLFNBQVNDLGNBQWMwSixHQUNwQzFLLEtBQUs4SyxLQUFPL0osU0FBU0MsY0FBYzJKLEdBQ25DM0ssS0FBSytLLFFBQVVoSyxTQUFTQyxjQUFjNEosR0FDdEM1SyxLQUFLbUssT0FBUyxFQUNsQixDQUVBYSxjQUNJLE1BQU8sQ0FDSDlLLEtBQU1GLEtBQUs2SyxNQUFNNUksWUFDakIwRyxJQUFLM0ksS0FBSzhLLEtBQUs3SSxZQUNmdUgsT0FBUXhKLEtBQUsrSyxRQUFRdkksSUFFN0IsQ0FFQXlJLFlBQVd2QyxHQUFrQixJQUFqQixLQUFFeEksRUFBSSxNQUFFOEksR0FBT04sRUFDdkIxSSxLQUFLNkssTUFBTTVJLFlBQWMvQixFQUN6QkYsS0FBSzhLLEtBQUs3SSxZQUFjK0csQ0FDNUIsQ0FFQWtDLGNBQWE5QixHQUFhLElBQVosT0FBRUksR0FBUUosRUFDcEJwSixLQUFLK0ssUUFBUXZJLElBQU1nSCxDQUN2QixHRnlDeUIsQ0FBRWtCLGFBQWMsc0JBQXVCQyxZQUFhLHFCQUFzQkMsZUFBZ0Isa0JBRWpIUixFQUFhLElHaEVKLGNBQTZCaEYsRUFDeEMxRixZQUFZMkYsR0FDUmdCLE1BQU1oQixHQUNOckYsS0FBS0MsT0FBU0QsS0FBS3NGLE9BQU90RSxjQUFjLHFCQUN4Q2hCLEtBQUttTCxPQUFTbkwsS0FBS3NGLE9BQU90RSxjQUFjLGtCQUM1QyxDQUVBd0UsS0FBS3RGLEVBQU1FLEdBQ1BpRyxNQUFNYixPQUNOeEYsS0FBS21MLE9BQU8zSSxJQUFNcEMsRUFDbEJKLEtBQUttTCxPQUFPMUksSUFBTXZDLEVBQ2xCRixLQUFLQyxPQUFPZ0MsWUFBYy9CLENBQzlCLEdIb0RrQyxjQU10QzBILEVBQUk2QixtQkFDRHhCLE1BQUt0RixJQUE2QixJQUEzQitHLEVBQVVDLEdBQVloSCxFQUM1QnVILEVBQVFlLFlBQVl2QixHQUNwQlEsRUFBUWdCLGNBQWN4QixHQUN0QlEsRUFBUUMsT0FBU1QsRUFBU3JKLElBQzFCcUgsRUFBUSxJQUFJaEYsRUFBUSxDQUNsQkcsTUFBTzhHLEVBQWE3RyxTQUFVZ0gsR0FDN0IsVUFFSHBDLEVBQU1yRSxhQUFhLElBRXBCaUgsT0FBTUMsR0FBT0MsUUFBUUMsSUFBSUYsS0FHNUIsTUFBTWEsRUFBbUIsSUFBSWpGLEVBQWMsa0JBQW1CeEcsSUFDNURpSSxFQUFJYSxvQkFBb0I5SSxHQUNyQnNJLE1BQU1DLElBQ0xzQyxRQUFRQyxJQUFJdkMsR0FDWmdDLEVBQVFlLFlBQVkvQyxHQUNwQmtELEVBQWlCM0YsT0FBTyxHQUN4QixJQUdBNEYsRUFBa0IsSUFBSWxGLEVBQWMsaUJBQWtCeEcsSUFDMUQ2SyxRQUFRQyxJQUFJOUssR0FDWmlJLEVBQUkwQixtQkFBbUIzSixHQUNwQnNJLE1BQU1DLElBQ0xzQyxRQUFRQyxJQUFJdkMsR0FDWmdDLEVBQVFnQixjQUFjaEQsR0FDdEJtRCxFQUFnQjVGLE9BQU8sSUFFeEI2RSxPQUFPQyxHQUFRQyxRQUFRQyxJQUFJRixJQUFLLElBRy9CZSxFQUFlLElBQUluRixFQUFjLGVBQWdCeEcsSUFDckRpSSxFQUFJdUIsV0FBVyxDQUFFakosS0FBTVAsRUFBSzRMLE1BQU9uTCxLQUFNVCxFQUFLUyxPQUMzQzZILE1BQU1DLElBQ0w0QixFQUFXNUIsR0FDWG9ELEVBQWE3RixPQUFPLElBRXJCNkUsT0FBT0MsSUFDTkMsUUFBUUMsSUFBSSxNQUFPRixFQUFJLEdBQ3ZCLElBR0FGLEVBQWtCLElJbkhULGNBQThCakYsRUFDekMxRixZQUFZMkYsRUFBT2UsR0FDZkMsTUFBTWhCLEdBQ05yRixLQUFLc0csY0FBZ0JGLEVBQ3JCcEcsS0FBS3VHLE1BQVF2RyxLQUFLc0YsT0FBT3RFLGNBQWMsU0FDdkNoQixLQUFLd0wsY0FBZ0J4TCxLQUFLdUcsTUFBTXZGLGNBQWMsZ0JBQ2xELENBRUFnRyxVQUFhMUYsSUFDVEEsRUFBRTJGLGlCQUNGakgsS0FBS3dMLGNBQWN2SixZQUFjLFlBQ2pDakMsS0FBS3NHLGNBQWN0RyxLQUFLeUwsTUFBTSxFQUdsQ3RLLHFCQUNJa0YsTUFBTWxGLHFCQUNObkIsS0FBS3VHLE1BQU1sRixpQkFBaUIsU0FBVXJCLEtBQUtnSCxVQUMvQyxDQUVBeEIsS0FBSzFELEdBQ0Q5QixLQUFLeUwsTUFBUTNKLEVBQ2J1RSxNQUFNYixNQUNWLENBRUFDLFFBQ0lZLE1BQU1aLFFBQ056RixLQUFLd0wsY0FBY3ZKLFlBQWMsS0FDckMsR0p3RndDLGlCQUFrQnRDLElBQzVEaUksRUFBSXlCLFdBQVcxSixHQUNac0ksTUFBTUMsSUFDUW5ILFNBQVNDLGNBQWUsU0FBUXJCLEtBQ3hDZ0MsU0FDTDBJLEVBQWdCNUUsUUFDaEIrRSxRQUFRQyxJQUFJLGVBQWUsSUFFNUJILE9BQU9DLElBQ05DLFFBQVFDLElBQUksTUFBT0YsRUFBSSxHQUN2QixJQXNCTmhELEVBQW1CbEcsaUJBQWlCLFNBQVMsS0FDM0NpSyxFQUFhOUYsT0FDYm1DLEVBQWdCLG9CQUFvQjdDLGlCQUFpQixJQUd2RHdDLEVBQWtCakcsaUJBQWlCLFNBakJuQyxXQUNFK0osRUFBaUJqRSxrQkFBa0IrQyxFQUFRYyxlQUMzQ0ksRUFBaUI1RixPQUNqQm1DLEVBQTZCLFlBQUU3QyxpQkFDakMsSUFjQTBDLEVBQWlCbkcsaUJBQWlCLFNBWmxDLFdBQ0VnSyxFQUFnQmxFLGtCQUFrQitDLEVBQVFjLGVBQzFDSyxFQUFnQjdGLE9BQ2hCbUMsRUFBOEIsYUFBRTdDLGlCQUNsQyxJQVlBMkMsRUFBWW5FLFNBQVFHLElBQ2xCLE1BQU1pSSxFQUFtQixJQUFJbkksRUFBYzZELEVBQWtCM0QsR0FDN0RpSSxFQUFpQjFHLG1CQUNqQjJDLEVBQWdCbEUsRUFBSzNCLElBQU00SixDQUFnQixHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL0FwaS5qcyIsIndlYnBhY2s6Ly93ZWJfcHJvamVjdF80Ly4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vd2ViX3Byb2plY3RfNC8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3dlYl9wcm9qZWN0XzQvLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XHJcbiAgICBjb25zdHJ1Y3RvcihkYXRhLCB0ZW1wbGF0ZVNlbGVjdG9yLCBoYW5kbGVDYXJkQ2xpY2ssIGhhbmRsZURlbGV0ZUNsaWNrLCBoYW5kbGVMaWtlQ2xpY2spIHtcclxuICAgICAgICB0aGlzLl90aXRsZSA9IGRhdGEubmFtZTtcclxuICAgICAgICB0aGlzLl9saW5rID0gZGF0YS5saW5rO1xyXG4gICAgICAgIHRoaXMuX2lkID0gZGF0YS5faWQ7XHJcbiAgICAgICAgdGhpcy5fdGVtcGxhdGVTZWxlY3RvciA9IHRlbXBsYXRlU2VsZWN0b3I7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrID0gaGFuZGxlRGVsZXRlQ2xpY2s7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrID0gaGFuZGxlTGlrZUNsaWNrO1xyXG4gICAgICAgIHRoaXMuX2xpa2VzID0gZGF0YS5saWtlcztcclxuICAgICAgICB0aGlzLl9vd25lcklkID0gZGF0YS5vd25lci5faWQ7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgICAgIGNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fdGVtcGxhdGVTZWxlY3RvcikuY29udGVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRcIikuY2xvbmVOb2RlKHRydWUpO1xyXG4gICAgICAgIHJldHVybiBjYXJkVGVtcGxhdGU7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIGNvbnN0IGRlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pY29uLWJpblwiKTtcclxuICAgICAgICBkZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sodGhpcy5faWQpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ljb25cIikuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChlKSA9PiB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljaygpO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1nXCIpLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sodGhpcy5fdGl0bGUsIHRoaXMuX2xpbmspO1xyXG4gICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBfc2V0TGlrZU9uKCkge1xyXG5cclxuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faWNvblwiKS5jbGFzc0xpc3QuYWRkKFwiY2FyZF9faWNvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcblxyXG4gICAgX3NldExpa2VPZmYoKSB7XHJcblxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19pY29uXCIpLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19pY29uX2FjdGl2ZVwiKTtcclxuICAgIH1cclxuXHJcbiAgICBfZGVsZXRlQ2FyZCgpIHtcclxuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSBudWxsO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBfaGFuZGxlSW5pdGlhbExpa2VzKGlkKSB7XHJcbiAgICAgICAgdGhpcy5fZWRpdExpa2VDb3VudGVyKGlkKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2lzTGlrZWQpIHtcclxuICAgICAgICAgICAgdGhpcy5fc2V0TGlrZU9uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9lZGl0TGlrZUNvdW50ZXIoKSB7XHJcbiAgICAgICAgY29uc3QgY2FyZExpa2VzID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2VzLWNvdW50ZXJcIik7XHJcbiAgICAgICAgY2FyZExpa2VzLnRleHRDb250ZW50ID0gdGhpcy5fbGlrZXMubGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIGdlbmVyYXRlQ2FyZChpZCkge1xyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgICAgIHRoaXMuX2lzTGlrZWQgPSB0aGlzLl9saWtlcy5zb21lKChsaWtlKSA9PiBsaWtlLl9pZCA9PT0gaWQpO1xyXG5cclxuICAgICAgICBjb25zdCBjYXJkSW1nID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltZ1wiKTtcclxuICAgICAgICBjb25zdCBjYXJkVGl0bGUgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcblxyXG4gICAgICAgIHRoaXMuX2VsZW1lbnQuaWQgPSAoYGNhcmQtJHt0aGlzLl9pZH1gKTtcclxuXHJcbiAgICAgICAgY2FyZEltZy5zcmMgPSB0aGlzLl9saW5rO1xyXG4gICAgICAgIGNhcmRJbWcuYWx0ID0gYFBob3RvIG9mICR7dGhpcy5fdGl0bGV9YDtcclxuICAgICAgICBjYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLl90aXRsZTtcclxuXHJcbiAgICAgICAgdGhpcy5faGFuZGxlSW5pdGlhbExpa2VzKGlkKTtcclxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5fb3duZXJJZCAhPT0gaWQpIHtcclxuICAgICAgICAgICAgY29uc3QgZGVsZXRlQnV0dG9uID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ljb24tYmluXCIpO1xyXG4gICAgICAgICAgICBkZWxldGVCdXR0b24ucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcblxyXG4gICAgfVxyXG5cclxuXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcclxuICAgIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICAgICAgdGhpcy5faXRlbXMgPSBpdGVtcztcclxuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZEl0ZW0oZWxlbWVudCkge1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlckl0ZW1zKCkge1xyXG4gICAgICAgIHRoaXMuX2l0ZW1zLmZvckVhY2godGhpcy5fcmVuZGVyZXIpO1xyXG4gICAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm0pIHtcclxuICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XHJcbiAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGZvcm07XHJcbiAgfVxyXG5cclxuICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuXHJcbiAgfVxyXG5cclxuICBfaGFzSW52YWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xyXG4gIH07XHJcblxyXG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcclxuICAgIGNvbnN0IGVycm9yRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX3NldHRpbmdzLmlucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiLlwiO1xyXG4gIH07XHJcblxyXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBpZiAoaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZSk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX3RvZ2dsZUJ1dHRvblN0YXRlKCkge1xyXG4gICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9zZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IGZhbHNlO1xyXG5cclxuICAgIH1cclxuICB9XHJcblxyXG4gIF9kaXNhYmxlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX3NldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudC5kaXNhYmxlZCA9IHRydWU7XHJcbiAgfVxyXG5cclxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XHJcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVzZXRWYWxpZGF0aW9uKCl7XHJcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaChpbnB1dCA9PiB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0KTtcclxuICAgIH0pXHJcbiAgICB0aGlzLl9kaXNhYmxlQnV0dG9uKCk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gWy4uLnRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5fc2V0dGluZ3MuaW5wdXRTZWxlY3RvcildO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICB9XHJcbn0iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xyXG4gICAgICAgIHRoaXMuX3BvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cCk7XHJcbiAgICAgICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLnBvcHVwX19jbG9zZS1idG5cIik7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbigpIHtcclxuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKFwicG9wdXBfb3BlbmVkXCIpO1xyXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZShcInBvcHVwX29wZW5lZFwiKTtcclxuICAgICAgICB0aGlzLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVFc2NDbG9zZSA9IChldnQpID0+IHtcclxuICAgICAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9oYW5kbGVNb3VzZUNsaWNrQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgaWYgKGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwicG9wdXBfb3BlbmVkXCIpKSB7XHJcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2hhbmRsZUJ0bkNsaWNrQ2xvc2UgPSAoZXZ0KSA9PiB7XHJcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9oYW5kbGVNb3VzZUNsaWNrQ2xvc2UpO1xyXG4gICAgICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVCdG5DbGlja0Nsb3NlKTtcclxuICAgIH1cclxuXHJcbiAgICBfcmVtb3ZlRXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgdGhpcy5faGFuZGxlTW91c2VDbGlja0Nsb3NlKTtcclxuICAgICAgICB0aGlzLl9jbG9zZUJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQnRuQ2xpY2tDbG9zZSk7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cCwgc3VibWl0Q2FsbGJhY2tGdW5jdGlvbikge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwKTtcclxuICAgICAgICB0aGlzLl9oYW5kbGVTdWJtaXQgPSBzdWJtaXRDYWxsYmFja0Z1bmN0aW9uO1xyXG4gICAgICAgIGNvbnN0IGlucHV0U2VsZWN0b3IgPSBcIi5mb3JtX19pbnB1dFwiO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKFwiLmZvcm1cIik7XHJcbiAgICAgICAgdGhpcy5fZm9ybVN1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcIi5mb3JtX19zdWJtaXRcIik7XHJcbiAgICAgICAgdGhpcy5fb3JpZ2luYWxCdXR0b25UZXh0ID0gdGhpcy5fZm9ybVN1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudDtcclxuICAgICAgICB0aGlzLl9pbnB1dHMgPSBBcnJheS5mcm9tKHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbChpbnB1dFNlbGVjdG9yKSk7XHJcbiAgICB9XHJcblxyXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlcyA9IHt9O1xyXG4gICAgICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xyXG4gICAgICAgICAgICB2YWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcclxuICAgICAgICB9KTtcclxuICAgICAgICByZXR1cm4gdmFsdWVzO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblN1Ym1pdCA9IChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm1TdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlNhdmluZy4uLlwiO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcclxuICAgIH07XHJcblxyXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9vblN1Ym1pdCk7XHJcbiAgICB9XHJcblxyXG4gICAgX3JlbW92ZUV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgICAgIHN1cGVyLl9yZW1vdmVFdmVudExpc3RlbmVycygpO1xyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVtb3ZlRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCB0aGlzLl9vblN1Ym1pdCk7XHJcbiAgICB9XHJcblxyXG4gICAgY2xvc2UoKSB7XHJcbiAgICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgICAgICB0aGlzLl9mb3JtU3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gdGhpcy5fb3JpZ2luYWxCdXR0b25UZXh0O1xyXG4gICAgICAgIHRoaXMuX2Zvcm0ucmVzZXQoKTtcclxuICAgIH1cclxuXHJcbiAgICBwcmVQb3B1bGF0ZUZpZWxkcyhkYXRhKSB7XHJcbiAgICAgICAgdGhpcy5faW5wdXRzLmZvckVhY2goKGlucHV0KSA9PiB7XHJcbiAgICAgICAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCJcclxuLy92YWxpZGF0aW9uIGNvbmZpZ1xyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvbkNvbmZpZyA9IHtcclxuICBmb3JtU2VsZWN0b3I6IFwiLmZvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5mb3JtX19pbnB1dFwiLFxyXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5mb3JtX19zdWJtaXRcIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcInBvcHVwX19maWVsZC1zdWJtaXRfaW5hY3RpdmVcIixcclxuICBpbnB1dEVycm9yQ2xhc3M6IFwiZm9ybV9faW5wdXQtZXJyb3JcIixcclxuICBlcnJvckNsYXNzOiBcInBvcHVwX19pbnB1dC1lcnJvcl9hY3RpdmVcIlxyXG59XHJcblxyXG4vL3Byb2ZpbGUgZWRpdCBmb3JtIGVsZW1lbnRzXHJcbmV4cG9ydCBjb25zdCBlZGl0UHJvZmlsZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9faW5mby1idG5cIik7XHJcbmV4cG9ydCBjb25zdCBuZXdDYXJkUG9wdXBCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idG5cIik7XHJcbmV4cG9ydCBjb25zdCBlZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19pbWctb3ZlcmxheVwiKTtcclxuZXhwb3J0IGNvbnN0IGNhcmRzQ29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc1wiKTtcclxuZXhwb3J0IGNvbnN0IGluaXRhbEZvcm1zID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHZhbGlkYXRpb25Db25maWcuZm9ybVNlbGVjdG9yKSk7XHJcblxyXG4vL2FwaSBrZXlzOlxyXG5leHBvcnQgY29uc3QgYXBpQ3JlZGVudGlhbHMgPSB7XHJcbiAgdG9rZW46IFwiMzM5MmE3YzMtNTM1OC00N2VlLTgxZmQtNjJmMzI3ODA2N2U1XCIsXHJcbiAgZ3JvdXBJRDogXCJjb2hvcnQtMy1lblwiXHJcbn07IiwiaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaVwiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aFN1Ym1pdCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhTdWJtaXQuanNcIjtcclxuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XHJcbmltcG9ydCB7IGVkaXRBdmF0YXJCdXR0b24sIHZhbGlkYXRpb25Db25maWcsIGVkaXRQcm9maWxlQnV0dG9uLCBuZXdDYXJkUG9wdXBCdXR0b24sIGluaXRhbEZvcm1zIH0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5cclxubGV0IGNhcmRzO1xyXG5jb25zdCBmb3Jtc1ZhbGlkYXRvcnMgPSB7fTtcclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC5ub21vcmVwYXJ0aWVzLmNvL3YxL2NvaG9ydC0zLWVuXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCIzMzkyYTdjMy01MzU4LTQ3ZWUtODFmZC02MmYzMjc4MDY3ZTVcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXHJcbiAgfVxyXG59KTtcclxuXHJcbi8vY2FyZCBmdW5jdGlvbnNcclxuY29uc3QgcmVuZGVyQ2FyZCA9IChjYXJkKSA9PiB7XHJcbiAgY29uc3QgbmV3Q2FyZCA9IG5ldyBDYXJkKGNhcmQsIFwiI2NhcmQtdGVtcGxhdGVcIiwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlRGVsZXRlQ2xpY2ssIGhhbmRsZUxpa2VDbGljayk7XHJcbiAgY2FyZHMuYWRkSXRlbShuZXdDYXJkLmdlbmVyYXRlQ2FyZChwcm9maWxlLnVzZXJJZCkpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKG5hbWUsIGxpbmspIHtcclxuICBpbWFnZVBvcHVwLm9wZW4obmFtZSwgbGluayk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGlkKSB7XHJcbiAgZGVsZXRlQ2FyZFBvcHVwLm9wZW4oaWQpO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soKSB7XHJcbiAgaWYgKHRoaXMuX2lzTGlrZWQgPT09IHRydWUpIHtcclxuICAgIGFwaS5yZW1vdmVMaWtlKHRoaXMuX2lkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fc2V0TGlrZU9mZigpO1xyXG4gICAgICAgIHRoaXMuX2lzTGlrZWQgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9saWtlcyA9IHJlcy5saWtlcztcclxuICAgICAgICB0aGlzLl9lZGl0TGlrZUNvdW50ZXIoKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IGNvbnNvbGUubG9nKGVycikpXHJcblxyXG4gIH1cclxuICBlbHNlIHtcclxuICAgIGFwaS5hZGRMaWtlKHRoaXMuX2lkKVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgdGhpcy5fc2V0TGlrZU9uKCk7XHJcbiAgICAgICAgdGhpcy5faXNMaWtlZCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fbGlrZXMgPSByZXMubGlrZXM7XHJcbiAgICAgICAgdGhpcy5fZWRpdExpa2VDb3VudGVyKCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuICB9XHJcblxyXG59XHJcblxyXG5cclxuLy9pbml0aWF0ZSBvYmplY3RzXHJcblxyXG5cclxuY29uc3QgcHJvZmlsZSA9IG5ldyBVc2VySW5mbyh7IG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9faW5mby1uYW1lXCIsIGpvYlNlbGVjdG9yOiBcIi5wcm9maWxlX19pbmZvLWpvYlwiLCBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1nXCIgfSk7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiLmltZy1wb3B1cFwiKTtcclxuXHJcbi8vIGFwaS5mZXRjaEluaXRpYWxEYXRhKFt0aGlzLmdldFVzZXJJbmZvcm1hdGlvbiwgdGhpcy5nZXRJbml0aWFsQ2FyZHNdKVxyXG4vLyAudGhlbihyZXMgPT4gY29uc29sZS5sb2cocmVzKSlcclxuLy8gLmNhdGNoKGVyciA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxuXHJcbmFwaS5mZXRjaEluaXRpYWxEYXRhKClcclxuICAudGhlbigoW3VzZXJJbmZvLCBpbml0aWFsQ2FyZF0pID0+IHtcclxuICAgIHByb2ZpbGUuc2V0VXNlckluZm8odXNlckluZm8pO1xyXG4gICAgcHJvZmlsZS5zZXRVc2VyQXZhdGFyKHVzZXJJbmZvKTtcclxuICAgIHByb2ZpbGUudXNlcklkID0gdXNlckluZm8uX2lkO1xyXG4gICAgY2FyZHMgPSBuZXcgU2VjdGlvbih7XHJcbiAgICAgIGl0ZW1zOiBpbml0aWFsQ2FyZCwgcmVuZGVyZXI6IHJlbmRlckNhcmRcclxuICAgIH0sIFwiLmNhcmRzXCIpO1xyXG5cclxuICAgIGNhcmRzLnJlbmRlckl0ZW1zKCk7XHJcbiAgfSlcclxuICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpO1xyXG5cclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5wcm9maWxlLXBvcHVwXCIsIChkYXRhKSA9PiB7XHJcbiAgYXBpLmVkaXRVc2VySW5mb3JtYXRpb24oZGF0YSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgcHJvZmlsZS5zZXRVc2VySW5mbyhyZXMpO1xyXG4gICAgICBlZGl0UHJvZmlsZVBvcHVwLmNsb3NlKCk7XHJcbiAgICB9KVxyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiLmF2YXRhci1wb3B1cFwiLCAoZGF0YSkgPT4ge1xyXG4gIGNvbnNvbGUubG9nKGRhdGEpO1xyXG4gIGFwaS5lZGl0UHJvZmlsZVBpY3R1cmUoZGF0YSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgY29uc29sZS5sb2cocmVzKTtcclxuICAgICAgcHJvZmlsZS5zZXRVc2VyQXZhdGFyKHJlcyk7XHJcbiAgICAgIGVkaXRBdmF0YXJQb3B1cC5jbG9zZSgpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKTtcclxufSk7XHJcblxyXG5jb25zdCBhZGRDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIi5jYXJkLXBvcHVwXCIsIChkYXRhKSA9PiB7XHJcbiAgYXBpLmFkZE5ld0NhcmQoeyBuYW1lOiBkYXRhLnRpdGxlLCBsaW5rOiBkYXRhLmxpbmsgfSlcclxuICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgcmVuZGVyQ2FyZChyZXMpO1xyXG4gICAgICBhZGRDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICBjb25zb2xlLmxvZyhcImVyclwiLCBlcnIpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG5cclxuY29uc3QgZGVsZXRlQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aFN1Ym1pdChcIi5kZWxldGUtcG9wdXBcIiwgKGRhdGEpID0+IHtcclxuICBhcGkuZGVsZXRlQ2FyZChkYXRhKVxyXG4gICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgI2NhcmQtJHtkYXRhfWApO1xyXG4gICAgICBjYXJkLnJlbW92ZSgpO1xyXG4gICAgICBkZWxldGVDYXJkUG9wdXAuY2xvc2UoKTtcclxuICAgICAgY29uc29sZS5sb2coXCJjYXJkIHJlbW92ZWRcIik7XHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgY29uc29sZS5sb2coXCJlcnJcIiwgZXJyKTtcclxuICAgIH0pO1xyXG59KTtcclxuXHJcbi8vIGNvbnN0IGNhcmRzID0gbmV3IFNlY3Rpb24oe1xyXG4vLyAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsIHJlbmRlcmVyOiByZW5kZXJDYXJkXHJcbi8vIH0sIFwiLmNhcmRzXCIpO1xyXG5cclxuLy8gY2FyZHMucmVuZGVySXRlbXMoKTtcclxuXHJcbi8vcHJvZmlsZSBwb3B1cCBvcGVuIGFuZCBwcmVwb3B1bGF0ZVxyXG5mdW5jdGlvbiBvcGVuUHJvZmlsZVBvcHVwKCkge1xyXG4gIGVkaXRQcm9maWxlUG9wdXAucHJlUG9wdWxhdGVGaWVsZHMocHJvZmlsZS5nZXRVc2VySW5mbygpKTtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxuICBmb3Jtc1ZhbGlkYXRvcnNbXCJwb3B1cF9fZm9ybVwiXS5yZXNldFZhbGlkYXRpb24oKTtcclxufVxyXG5cclxuZnVuY3Rpb24gb3BlblByb2ZpbGVBdmF0YXIoKSB7XHJcbiAgZWRpdEF2YXRhclBvcHVwLnByZVBvcHVsYXRlRmllbGRzKHByb2ZpbGUuZ2V0VXNlckluZm8oKSk7XHJcbiAgZWRpdEF2YXRhclBvcHVwLm9wZW4oKTtcclxuICBmb3Jtc1ZhbGlkYXRvcnNbXCJhdmF0YXJfX2Zvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn1cclxuLy9zZXQgYnV0dG9uIGV2ZW50IGxpc3RlbmVyc1xyXG5uZXdDYXJkUG9wdXBCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBhZGRDYXJkUG9wdXAub3BlbigpO1xyXG4gIGZvcm1zVmFsaWRhdG9yc1tcImNhcmQtcG9wdXBfX2Zvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuZWRpdFByb2ZpbGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIG9wZW5Qcm9maWxlUG9wdXApO1xyXG5lZGl0QXZhdGFyQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBvcGVuUHJvZmlsZUF2YXRhcik7XHJcblxyXG5cclxuLy9pbml0aWF0ZSBmb3JtcyB2YWxpZGF0aW9uXHJcbmluaXRhbEZvcm1zLmZvckVhY2goZm9ybSA9PiB7XHJcbiAgY29uc3QgbmV3Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHZhbGlkYXRpb25Db25maWcsIGZvcm0pO1xyXG4gIG5ld0Zvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG4gIGZvcm1zVmFsaWRhdG9yc1tmb3JtLmlkXSA9IG5ld0Zvcm1WYWxpZGF0b3I7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gICAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgICAgICB0aGlzLmJhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgICAgIHRoaXMuaGVhZGVycyA9IGhlYWRlcnM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mb3JtYXRpb24oKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGVkaXRVc2VySW5mb3JtYXRpb24oeyBuYW1lLCBqb2IgfSkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgYWJvdXQ6IGpvYlxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFkZExpa2UoaWQpIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS9jYXJkcy9saWtlcy8ke2lkfWAsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnNcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmVtb3ZlTGlrZShpZCkge1xyXG4gICAgICAgIHJldHVybiBmZXRjaChgJHt0aGlzLmJhc2VVcmx9L2NhcmRzL2xpa2VzLyR7aWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVyc1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBhZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuaGVhZGVycyxcclxuICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgICAgICAgICAgbmFtZTogbmFtZSxcclxuICAgICAgICAgICAgICAgIGxpbms6IGxpbmtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudGhlbihyZXMgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICAgICAgcmV0dXJuIGZldGNoKGAke3RoaXMuYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICAgICAgaGVhZGVyczogdGhpcy5oZWFkZXJzXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZWRpdFByb2ZpbGVQaWN0dXJlKHsgYXZhdGFyIH0pIHtcclxuICAgICAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICAgICAgICBoZWFkZXJzOiB0aGlzLmhlYWRlcnMsXHJcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICAgICAgICAgIGF2YXRhcjogYXZhdGFyXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfSlcclxuICAgICAgICAgICAgLnRoZW4ocmVzID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgZmV0Y2hJbml0aWFsRGF0YSgpIHtcclxuICAgICAgICBjb25zdCB1c2VySW5mbyA9IHRoaXMuZ2V0VXNlckluZm9ybWF0aW9uKCk7XHJcbiAgICAgICAgY29uc3QgaW5pdGlhbENhcmQgPSB0aGlzLmdldEluaXRpYWxDYXJkcygpO1xyXG5cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3VzZXJJbmZvLCBpbml0aWFsQ2FyZF0pO1xyXG4gICAgfVxyXG59XHJcblxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XHJcbiAgICBjb25zdHJ1Y3Rvcih7IG5hbWVTZWxlY3Rvciwgam9iU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcclxuICAgICAgICB0aGlzLl9uYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihuYW1lU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2pvYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3Ioam9iU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMuX2F2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoYXZhdGFyU2VsZWN0b3IpO1xyXG4gICAgICAgIHRoaXMudXNlcklkID0gXCJcIjtcclxuICAgIH1cclxuXHJcbiAgICBnZXRVc2VySW5mbygpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICAgICAgICBqb2I6IHRoaXMuX2pvYi50ZXh0Q29udGVudCxcclxuICAgICAgICAgICAgYXZhdGFyOiB0aGlzLl9hdmF0YXIuc3JjXHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJJbmZvKHsgbmFtZSwgYWJvdXQgfSkge1xyXG4gICAgICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgICAgIHRoaXMuX2pvYi50ZXh0Q29udGVudCA9IGFib3V0O1xyXG4gICAgfVxyXG5cclxuICAgIHNldFVzZXJBdmF0YXIoeyBhdmF0YXIgfSkge1xyXG4gICAgICAgIHRoaXMuX2F2YXRhci5zcmMgPSBhdmF0YXI7XHJcbiAgICB9XHJcblxyXG59IiwiaW1wb3J0IFBvcHVwIGZyb20gJy4vUG9wdXAuanMnO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgICBjb25zdHJ1Y3Rvcihwb3B1cCkge1xyXG4gICAgICAgIHN1cGVyKHBvcHVwKTtcclxuICAgICAgICB0aGlzLl90aXRsZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuaW1nLXBvcHVwX190aXRsZVwiKTtcclxuICAgICAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuaW1nLXBvcHVwX19pbWdcIik7XHJcbiAgICB9XHJcblxyXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XHJcbiAgICAgICAgc3VwZXIub3BlbigpO1xyXG4gICAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgICAgICB0aGlzLl90aXRsZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aFN1Ym1pdCBleHRlbmRzIFBvcHVwIHtcclxuICAgIGNvbnN0cnVjdG9yKHBvcHVwLCBzdWJtaXRDYWxsYmFja0Z1bmN0aW9uKSB7XHJcbiAgICAgICAgc3VwZXIocG9wdXApO1xyXG4gICAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdCA9IHN1Ym1pdENhbGxiYWNrRnVuY3Rpb247XHJcbiAgICAgICAgdGhpcy5fZm9ybSA9IHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybVwiKTtcclxuICAgICAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXCIuZm9ybV9fc3VibWl0XCIpO1xyXG4gICAgfVxyXG5cclxuICAgIF9vblN1Ym1pdCA9IChlKSA9PiB7XHJcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICAgICAgdGhpcy5faGFuZGxlU3VibWl0KHRoaXMuaW1nSWQpO1xyXG4gICAgfTtcclxuXHJcbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICAgICAgc3VwZXIuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICAgICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX29uU3VibWl0KTtcclxuICAgIH1cclxuXHJcbiAgICBvcGVuKGlkKSB7XHJcbiAgICAgICAgdGhpcy5pbWdJZCA9IGlkO1xyXG4gICAgICAgIHN1cGVyLm9wZW4oKTtcclxuICAgIH1cclxuXHJcbiAgICBjbG9zZSgpIHtcclxuICAgICAgICBzdXBlci5jbG9zZSgpO1xyXG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XHJcbiAgICB9XHJcblxyXG59Il0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsImRhdGEiLCJ0ZW1wbGF0ZVNlbGVjdG9yIiwiaGFuZGxlQ2FyZENsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJ0aGlzIiwiX3RpdGxlIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl90ZW1wbGF0ZVNlbGVjdG9yIiwiX2hhbmRsZUNhcmRDbGljayIsIl9oYW5kbGVEZWxldGVDbGljayIsIl9oYW5kbGVMaWtlQ2xpY2siLCJfbGlrZXMiLCJsaWtlcyIsIl9vd25lcklkIiwib3duZXIiLCJfZ2V0VGVtcGxhdGUiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2VsZW1lbnQiLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsIl9zZXRMaWtlT24iLCJjbGFzc0xpc3QiLCJhZGQiLCJfc2V0TGlrZU9mZiIsInJlbW92ZSIsIl9kZWxldGVDYXJkIiwiX2hhbmRsZUluaXRpYWxMaWtlcyIsImlkIiwiX2VkaXRMaWtlQ291bnRlciIsIl9pc0xpa2VkIiwidGV4dENvbnRlbnQiLCJsZW5ndGgiLCJnZW5lcmF0ZUNhcmQiLCJzb21lIiwibGlrZSIsImNhcmRJbWciLCJjYXJkVGl0bGUiLCJzcmMiLCJhbHQiLCJTZWN0aW9uIiwiX3JlZiIsImNvbnRhaW5lclNlbGVjdG9yIiwiaXRlbXMiLCJyZW5kZXJlciIsIl9pdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJhZGRJdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJyZW5kZXJJdGVtcyIsImZvckVhY2giLCJGb3JtVmFsaWRhdG9yIiwic2V0dGluZ3MiLCJmb3JtIiwiX3NldHRpbmdzIiwiX2Zvcm1FbGVtZW50IiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JFbGVtZW50IiwiaW5wdXRFcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9oYXNJbnZhbGlkSW5wdXQiLCJfaW5wdXRMaXN0IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl90b2dnbGVCdXR0b25TdGF0ZSIsIl9kaXNhYmxlQnV0dG9uIiwiX2J1dHRvbkVsZW1lbnQiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiZGlzYWJsZWQiLCJyZXNldFZhbGlkYXRpb24iLCJpbnB1dCIsImVuYWJsZVZhbGlkYXRpb24iLCJxdWVyeVNlbGVjdG9yQWxsIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiUG9wdXAiLCJwb3B1cCIsIl9wb3B1cCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJjbG9zZSIsIl9yZW1vdmVFdmVudExpc3RlbmVycyIsIl9oYW5kbGVFc2NDbG9zZSIsImV2dCIsImtleSIsIl9oYW5kbGVNb3VzZUNsaWNrQ2xvc2UiLCJ0YXJnZXQiLCJjb250YWlucyIsIl9oYW5kbGVCdG5DbGlja0Nsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIlBvcHVwV2l0aEZvcm0iLCJzdWJtaXRDYWxsYmFja0Z1bmN0aW9uIiwic3VwZXIiLCJfaGFuZGxlU3VibWl0IiwiX2Zvcm0iLCJfZm9ybVN1Ym1pdEJ1dHRvbiIsIl9vcmlnaW5hbEJ1dHRvblRleHQiLCJfaW5wdXRzIiwiQXJyYXkiLCJmcm9tIiwiX2dldElucHV0VmFsdWVzIiwidmFsdWVzIiwidmFsdWUiLCJfb25TdWJtaXQiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0IiwicHJlUG9wdWxhdGVGaWVsZHMiLCJ2YWxpZGF0aW9uQ29uZmlnIiwiZm9ybVNlbGVjdG9yIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJuZXdDYXJkUG9wdXBCdXR0b24iLCJlZGl0QXZhdGFyQnV0dG9uIiwiaW5pdGFsRm9ybXMiLCJjYXJkcyIsImZvcm1zVmFsaWRhdG9ycyIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJ0aGVuIiwicmVzIiwib2siLCJqc29uIiwiUHJvbWlzZSIsInJlamVjdCIsInN0YXR1cyIsImdldFVzZXJJbmZvcm1hdGlvbiIsImVkaXRVc2VySW5mb3JtYXRpb24iLCJfcmVmMiIsImpvYiIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGRMaWtlIiwicmVtb3ZlTGlrZSIsImFkZE5ld0NhcmQiLCJfcmVmMyIsImRlbGV0ZUNhcmQiLCJlZGl0UHJvZmlsZVBpY3R1cmUiLCJfcmVmNCIsImF2YXRhciIsImZldGNoSW5pdGlhbERhdGEiLCJ1c2VySW5mbyIsImluaXRpYWxDYXJkIiwiYWxsIiwiYXV0aG9yaXphdGlvbiIsInJlbmRlckNhcmQiLCJjYXJkIiwibmV3Q2FyZCIsImhhbmRsZUltYWdlQ2xpY2siLCJwcm9maWxlIiwidXNlcklkIiwiaW1hZ2VQb3B1cCIsImRlbGV0ZUNhcmRQb3B1cCIsImNhdGNoIiwiZXJyIiwiY29uc29sZSIsImxvZyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfbmFtZSIsIl9qb2IiLCJfYXZhdGFyIiwiZ2V0VXNlckluZm8iLCJzZXRVc2VySW5mbyIsInNldFVzZXJBdmF0YXIiLCJfaW1hZ2UiLCJlZGl0UHJvZmlsZVBvcHVwIiwiZWRpdEF2YXRhclBvcHVwIiwiYWRkQ2FyZFBvcHVwIiwidGl0bGUiLCJfc3VibWl0QnV0dG9uIiwiaW1nSWQiLCJuZXdGb3JtVmFsaWRhdG9yIl0sInNvdXJjZVJvb3QiOiIifQ==